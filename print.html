<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Clair Documentation</title>
        
        <meta name="robots" content="noindex" />
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Documentation for Clair.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="favicon.svg">
        
        
        <link rel="shortcut icon" href="favicon.png">
        
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "coal" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="whatis.html"><strong aria-hidden="true">1.</strong> What is ClairV4</a></li><li class="chapter-item expanded "><a href="howto.html"><strong aria-hidden="true">2.</strong> How Tos</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="howto/getting_started.html"><strong aria-hidden="true">2.1.</strong> Getting Started With ClairV4</a></li><li class="chapter-item expanded "><a href="howto/deployment.html"><strong aria-hidden="true">2.2.</strong> Deployment Models</a></li><li class="chapter-item expanded "><a href="howto/api.html"><strong aria-hidden="true">2.3.</strong> API Definition</a></li><li class="chapter-item expanded "><a href="howto/testing.html"><strong aria-hidden="true">2.4.</strong> Testing ClairV4</a></li></ol></li><li class="chapter-item expanded "><a href="concepts.html"><strong aria-hidden="true">3.</strong> Concepts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="concepts/api_internal.html"><strong aria-hidden="true">3.1.</strong> Internal API</a></li><li class="chapter-item expanded "><a href="concepts/authentication.html"><strong aria-hidden="true">3.2.</strong> Authentication</a></li><li class="chapter-item expanded "><a href="concepts/notifications.html"><strong aria-hidden="true">3.3.</strong> Notifications</a></li><li class="chapter-item expanded "><a href="concepts/updatersandairgap.html"><strong aria-hidden="true">3.4.</strong> Updaters and Airgap</a></li></ol></li><li class="chapter-item expanded "><a href="contribution.html"><strong aria-hidden="true">4.</strong> Contribution</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="contribution/releases.html"><strong aria-hidden="true">4.1.</strong> Releases</a></li><li class="chapter-item expanded "><a href="contribution/commit_style.html"><strong aria-hidden="true">4.2.</strong> Commit Style</a></li></ol></li><li class="chapter-item expanded "><a href="reference.html"><strong aria-hidden="true">5.</strong> Reference</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="reference/api.html"><strong aria-hidden="true">5.1.</strong> Api</a></li><li class="chapter-item expanded "><a href="reference/clairctl.html"><strong aria-hidden="true">5.2.</strong> Clairctl</a></li><li class="chapter-item expanded "><a href="reference/config.html"><strong aria-hidden="true">5.3.</strong> Config</a></li><li class="chapter-item expanded "><a href="reference/indexer.html"><strong aria-hidden="true">5.4.</strong> Indexer</a></li><li class="chapter-item expanded "><a href="reference/matcher.html"><strong aria-hidden="true">5.5.</strong> Matcher</a></li><li class="chapter-item expanded "><a href="reference/notifier.html"><strong aria-hidden="true">5.6.</strong> Notifier</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Clair Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        <a href="https://github.com/quay/clair" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#what-is-clair" id="what-is-clair">What is Clair</a></h1>
<p>Clair is an application for parsing image contents and reporting vulnerabilities affecting the contents. This is done via static analysis and not at runtime.</p>
<h2><a class="header" href="#architecture" id="architecture">Architecture</a></h2>
<p>Clair v4 utilizes the <a href="https://quay.github.io/claircore/">ClairCore</a> library as its engine for examining contents and reporting vulnerabilities. At a high level you can consider Clair a service wrapper to the functionality provided in the ClairCore library. </p>
<p><img src="./clairv4_arch.png" alt="diagram of clairV4 highlevel architecture" /></p>
<p>The above diagram expresses the separation of concerns between Clair and the ClairCore library. Most development involving new distributions, vulnerability sources, and layer indexing will occur in ClairCore.</p>
<h2><a class="header" href="#how-clair-works" id="how-clair-works">How Clair Works</a></h2>
<p>Clair's analysis is broken into three distinct parts.</p>
<h3><a class="header" href="#indexing" id="indexing">Indexing</a></h3>
<p>Indexing starts with submitting a Manifest to Clair. On receipt, Clair will fetch layers, scan their contents, and return an intermediate representation called an IndexReport. </p>
<p>Manifests are Clair's representation of a container image. Clair leverages the fact that OCI Manifests and Layers are content-addressed to reduce duplicated work.</p>
<p>Once a Manifest is indexed, the IndexReport is persisted for later retrieval. </p>
<h3><a class="header" href="#matching" id="matching">Matching</a></h3>
<p>Matching is taking an IndexReport and correlating vulnerabilities affecting the manifest the report represents. </p>
<p>Clair is continually ingesting new security data and a request to the matcher will always provide you with the most up to date vulnerability analysis of an IndexReport.</p>
<p><em>How we implement indexing and matching in detail is covered in <a href="https://quay.github.io/claircore/">ClairCore's</a> documentation.</em></p>
<h3><a class="header" href="#notifications" id="notifications">Notifications</a></h3>
<p>Clair implements a notification service. </p>
<p>When new vulnerabilities are discovered, the notifier service will determine if these vulnerabilities affect any indexed Manifests. The notifier will then take action according to its configuration.</p>
<h3><a class="header" href="#getting-started" id="getting-started">Getting Started</a></h3>
<p>At this point you'll probably want to check out <a href="./howto/getting_started.html">Getting Started With Clair</a>.</p>
<h1><a class="header" href="#how-tos" id="how-tos">How Tos</a></h1>
<p>The following sections provide instructions on accomplish specific goals in Clair.</p>
<ul>
<li><a href="./howto/api.html">API Definition</a></li>
<li><a href="./howto/deployment.html">Deployment Models</a></li>
<li><a href="./howto/getting_started.html">Getting Started</a></li>
<li><a href="./howto/testing.html">Testing ClairV4</a></li>
</ul>
<h1><a class="header" href="#getting-started-with-clair" id="getting-started-with-clair">Getting Started With Clair</a></h1>
<h2><a class="header" href="#releases" id="releases">Releases</a></h2>
<p>All of the source code needed to build clair is packaged as an archive and
attached to the release. Releases are tracked at the <a href="https://github.com/quay/clair/releases">github releases</a>.</p>
<p>The release artifacts also include the clairctl command line tool.</p>
<h2><a class="header" href="#official-containers" id="official-containers">Official Containers</a></h2>
<p>Clair is officially packaged and released as a container at
<a href="https://quay.io/repository/projectquay/clair">quay.io/projectquay/clair</a>. The <code>latest</code> tag tracks the git development branch,
and version tags are built from the corresponding release.</p>
<h2><a class="header" href="#running-clair" id="running-clair">Running Clair</a></h2>
<p>The easiest way to get Clair up and running for test purposes is to use our <a href="howto/./testing.html">local dev environment</a></p>
<p>If you're the hands on type who wants to get into the details however, continue reading.</p>
<h2><a class="header" href="#modes" id="modes">Modes</a></h2>
<p>Clair can run in several modes. <a href="howto/../reference/indexer.html">Indexer</a>, <a href="howto/../reference/matcher.html">matcher</a>, <a href="howto/../reference/notifier.html">notifier</a> or combo mode. In combo mode, everything runs in a single OS process. </p>
<p>If you are just starting with Clair you will most likely want to start with combo mode and venture out to a distributed deployment once acquainted. </p>
<p>This how-to will demonstrate combo mode and introduce some further reading on a distributed deployment.</p>
<h2><a class="header" href="#postgres" id="postgres">Postgres</a></h2>
<p>Clair uses PostgreSQL for its data persistence. Migrations are supported so you should only need to point Clair to a fresh database and have it do the setup for you.</p>
<p>We will assume you have setup a postgres database it's reachable with the following connection string:
<code>host=clair-db port=5432 user=clair dbname=clair sslmode=disable</code>. Adjust for your environment accordingly. </p>
<h2><a class="header" href="#starting-clair-in-combo-mode" id="starting-clair-in-combo-mode">Starting Clair In Combo Mode</a></h2>
<p>At this point, you should either have built Clair from source or have pulled the container. In either case, we will assume that the <code>clair-db</code> hostname will resolve to your postgres database. </p>
<p><em>You may need to configure <a href="https://docs.docker.com/network/">docker</a> or <a href="https://podman.io/getting-started/network.html">podman</a> networking if you are utilizing containers. This is out of scope for this how-to.</em></p>
<p>A basic config for combo mode can be found <a href="https://github.com/quay/clair/blob/development-4.0/config.yaml.sample">here</a>. Make sure to edit this config with your database settings and set &quot;migrations&quot; to <code>true</code> for all mode stanzas. In this basic combo mode, all &quot;connstring&quot; fields should point to the same database and any *_addr fields are simply ignored. For more details see the <a href="howto/../reference/config.html">config reference</a> and <a href="howto/./deployment.html">deployment models</a></p>
<p>Clair has 3 requirements to start:</p>
<ul>
<li>The <code>mode</code> flag or <code>CLAIR_MODE</code> environment variable specifying what mode this instance will run in.</li>
<li>The <code>conf</code> flag or <code>CLAIR_CONF</code> environment variable specifying where Clair can find its configuration.</li>
<li>A yaml document providing Clair's configuration.</li>
</ul>
<p>If you are running a container, you can can <a href="https://docs.docker.com/storage/volumes/">mount</a> a Clair config and set the <code>CLAIR_CONF</code> environment variable to the corresponding path.</p>
<pre><code>CLAIR_MODE=combo
CLAIR_CONF=/path/to/mounted/config.yaml
</code></pre>
<p>If you are running a Clair binary directly, its likely easiest to use the command line.</p>
<pre><code>clair -conf &quot;path/to/config.yaml&quot; -mode &quot;combo&quot;
</code></pre>
<h2><a class="header" href="#submitting-a-manifest" id="submitting-a-manifest">Submitting A Manifest</a></h2>
<p>The simplest way to submit a manifest to your running Clair is utilizing <a href="howto/../reference/clairctl.html">clairctl</a>. This is a CLI tool capable of grabbing image manifests from public repositories and and submitting them for analysis. 
The command will be in the Clair container, but can also be installed locally by running the following command:</p>
<pre><code>go install github.com/quay/clair/v4/cmd/clairctl
</code></pre>
<p>You can submit a manifest to ClairV4 via the following command.</p>
<pre><code class="language-shell">$ clairctl --host ${net_address_of_clair} report ${image_tag}
</code></pre>
<p>By default, <code>clairctl</code> will look for Clair at <code>localhost:6060</code>.</p>
<p>If everything is configured correctly, you should see some output like the following informing you of vulnerabilities affecting the supplied image.</p>
<pre><code class="language-shell">$ clairctl report ubuntu:focal
ubuntu:focal found bash        5.0-6ubuntu1.1         CVE-2019-18276
ubuntu:focal found libpcre3    2:8.39-12build1        CVE-2017-11164
ubuntu:focal found libpcre3    2:8.39-12build1        CVE-2019-20838
ubuntu:focal found libpcre3    2:8.39-12build1        CVE-2020-14155
ubuntu:focal found libsystemd0 245.4-4ubuntu3.2       CVE-2018-20839
ubuntu:focal found libsystemd0 245.4-4ubuntu3.2       CVE-2020-13776
ubuntu:focal found libtasn1-6  4.16.0-2               CVE-2018-1000654
ubuntu:focal found libudev1    245.4-4ubuntu3.2       CVE-2018-20839
ubuntu:focal found libudev1    245.4-4ubuntu3.2       CVE-2020-13776
ubuntu:focal found login       1:4.8.1-1ubuntu5.20.04 CVE-2013-4235
ubuntu:focal found login       1:4.8.1-1ubuntu5.20.04 CVE-2018-7169
ubuntu:focal found coreutils   8.30-3ubuntu2          CVE-2016-2781
ubuntu:focal found passwd      1:4.8.1-1ubuntu5.20.04 CVE-2013-4235
ubuntu:focal found passwd      1:4.8.1-1ubuntu5.20.04 CVE-2018-7169
ubuntu:focal found perl-base   5.30.0-9build1         CVE-2020-10543
ubuntu:focal found perl-base   5.30.0-9build1         CVE-2020-10878
ubuntu:focal found perl-base   5.30.0-9build1         CVE-2020-12723
ubuntu:focal found tar         1.30+dfsg-7            CVE-2019-9923
ubuntu:focal found dpkg        1.19.7ubuntu3          CVE-2017-8283
ubuntu:focal found gpgv        2.2.19-3ubuntu2        CVE-2019-13050
ubuntu:focal found libc-bin    2.31-0ubuntu9          CVE-2016-10228
ubuntu:focal found libc-bin    2.31-0ubuntu9          CVE-2020-6096
ubuntu:focal found libc6       2.31-0ubuntu9          CVE-2016-10228
ubuntu:focal found libc6       2.31-0ubuntu9          CVE-2020-6096
ubuntu:focal found libgcrypt20 1.8.5-5ubuntu1         CVE-2019-12904
</code></pre>
<h2><a class="header" href="#whats-next" id="whats-next">What's Next</a></h2>
<p>Now that you see the basic usage of Clair, you can checkout our <a href="howto/./deployment.html">deployment models</a> to learn different ways of deploying.</p>
<p>You may also be curious about how <code>clairctl</code> did that work. Check out our <a href="howto/./api.html">API definition</a> to understand how an application interacts with Clair.</p>
<h1><a class="header" href="#deploying-clair" id="deploying-clair">Deploying Clair</a></h1>
<p>Clair v4 was designed with flexible deployment architectures in mind. The operator is free to choose a deployment model which scales to their use cases.</p>
<h2><a class="header" href="#configuration" id="configuration">Configuration</a></h2>
<p>Before jumping directly into the models its important to note that Clair is designed to use a single configuration file across all node types. This design decision makes it very easy to deploy on systems like Kubernetes and OpenShift.</p>
<p>See <a href="howto/../reference/config.html">Config Reference</a></p>
<h2><a class="header" href="#combined-deployment" id="combined-deployment">Combined Deployment</a></h2>
<p>In a combined deployment, all the Clair processes run in a single OS process. This is by far the easiest deployment model to configure as it involves the least moving parts. </p>
<p>A load balancer is still recommended if you plan on performing TLS termination. Typically this will be a OpenShift route or a Kubernetes ingress.</p>
<p><img src="howto/./clairv4_combo_single_db.png" alt="combo mode single db deployment diagran" /></p>
<p>In the above diagram, Clair is running in combo mode and talking to a single database. To configure this model you will provide all node types the same database and start Clair in <strong>combo</strong> mode.</p>
<pre><code>...
indexer:
    connstring: &quot;host=clairdb user=pqgotest dbname=pqgotest sslmode=verify-full&quot;
matcher:
    connstring: &quot;host=cher-clairdb user=pqgotest dbname=pqgotest sslmode=verify-full&quot;
    ...
notifier:
    connstring: &quot;host=clairdb user=pqgotest dbname=pqgotest sslmode=verify-full&quot;
    ...
</code></pre>
<p>In this mode, any configuration informing Clair how to talk to other nodes is ignored, it is not needed as all intra-process communication is done directly.</p>
<p>For added flexibility, it's also supported to split the databases while in combo mode.</p>
<p><img src="howto/./clairv4_combo_multi_db.png" alt="combo mode multiple db deployment diagran" /></p>
<p>In the above diagram, Clair is running in combo mode but database load is split between multiple databases. Since Clair is conceptually a set of micro-services, its processes do not share database tables even when combined into the same OS process.</p>
<p>To configure this model, you would provide each process its own &quot;connstring&quot; in the configuration. </p>
<pre><code>...
indexer:
    connstring: &quot;host=indexer-clairdb user=pqgotest dbname=pqgotest sslmode=verify-full&quot;
matcher:
    connstring: &quot;host=matcher-clairdb user=pqgotest dbname=pqgotest sslmode=verify-full&quot;
    ...
notifier:
    connstring: &quot;host=notifier-clairdb user=pqgotest dbname=pqgotest sslmode=verify-full&quot;
    ...
</code></pre>
<h2><a class="header" href="#distributed-deployment" id="distributed-deployment">Distributed Deployment</a></h2>
<p>If your application needs to asymmetrically scale or you expect high load you may want to consider a distributed deployment.</p>
<p>In a distributed deployment, each Clair process runs in its own OS process. Typically this will be a Kubernetes or OpenShift Pod.</p>
<p>A load balancer <strong>must</strong> be setup in this deployment model. The load balancer will route traffic between Clair nodes along with routing API requests via <a href="https://devcentral.f5.com/s/articles/the-three-http-routing-patterns-you-should-know-30764">path based routing</a> to the correct services. In a Kubernetes or OpenShift deployment this is usually handled with the Service and Routes abstractions. If deploying on bare metal, a load balancer will need to be configured appropriately. </p>
<p><img src="howto/./clairv4_distributed_multi_db.png" alt="distributed mode multiple db deployment diagran" /></p>
<p>In the above diagram, a load balancer is configured to route traffic coming from the client to the correct service. This routing is path based routing and requires a layer 7 load balancer. Traefik, Nginx, and HAProxy are all capable of this. As mentioned above, this functionality is native to OpenShift and Kubernetes.</p>
<p>In this configuration, you'd supply each process with database connection strings and addresses for their dependent services. Each OS process will need to have its &quot;mode&quot; CLI flag or environment variable set to the appropriate value. 
See <a href="howto/../reference/config.html">Config Reference</a></p>
<pre><code>...
indexer:
    connstring: &quot;host=indexer-clairdb user=pqgotest dbname=pqgotest sslmode=verify-full&quot;
matcher:
    connstring: &quot;host=matcher-clairdb user=pqgotest dbname=pqgotest sslmode=verify-full&quot;
    indexer_addr: &quot;indexer-service&quot;
    ...
notifier:
    connstring: &quot;host=notifier-clairdb user=pqgotest dbname=pqgotest sslmode=verify-full&quot;
    indexer_addr: &quot;indexer-service&quot;
    matcher_addr: &quot;matcher-service&quot;
    ...
</code></pre>
<p>Keep in mind a config file per process is not need. Processes only use the values necessary for their configured mode.</p>
<h2><a class="header" href="#tls-termination" id="tls-termination">TLS Termination</a></h2>
<p>Currently Clair offloads TLS termination to the load balancing infrastructure. This design choice is due to the ubiquity of Kubernetes and OpenShift infrastructure already providing this facility.</p>
<h2><a class="header" href="#more-on-path-routing" id="more-on-path-routing">More On Path Routing</a></h2>
<p>If you are considering a distributed deployment you will need more details on <a href="https://devcentral.f5.com/s/articles/the-three-http-routing-patterns-you-should-know-30764">path based routing</a>. </p>
<p>Learn how to grab our OpenAPI spec <a href="howto/./api.mw">here</a> and either start up a local dev instance of the swagger editor or load the spec file into the <a href="https://petstore.swagger.io/#/">online editor</a></p>
<p>You will notice particular API paths are grouped by the services which implement them. This is your guide to configure your layer 7 load balancer correctly. </p>
<p>When the load balancer encounters a particular path prefix it must send those request to the correct set of Clair nodes. </p>
<p>For example, this is how we configure Traefik in our local development environment:</p>
<pre><code>&quot;traefik.enable=true&quot;
&quot;traefik.http.routers.notifications.entrypoints=clair&quot;
&quot;traefik.http.routers.notifications.rule=PathPrefix(`/api/v1/notification`)&quot;
&quot;traefik.http.routers.notifications.service=notifications&quot;
&quot;traefik.http.services.notifications.loadbalancer.server.port=6000&quot;
</code></pre>
<p>This configuration is saying &quot;take any paths prefixes of /api/v1/notification and send them to the notifier services on port 6060&quot;</p>
<p>Every load balancer will have their own way to perform path routing. Check the documentation for your infrastructure of choice.</p>
<h1><a class="header" href="#api-definition" id="api-definition">API Definition</a></h1>
<p>Clair provides its API definition via an OpenAPI specification. You can view our OpenAPI spec <a href="https://raw.githubusercontent.com/quay/clair/development-4.0/openapi.yaml">here</a></p>
<p>The OpenAPI spec can be used in a variety of ways.</p>
<ul>
<li>Generating http clients for your application</li>
<li>Validating data returned from Clair</li>
<li>Importing into a rest client such as <a href="https://learning.postman.com/docs/integrations/available-integrations/working-with-openAPI/">Postman</a></li>
<li>API documentation via <a href="https://petstore.swagger.io/#/">Swagger Editor</a></li>
</ul>
<p>See <a href="howto/./testing.html">Testing Clair</a> to learn how the local dev tooling starts a local swagger editor. This is handy for making changes to the spec in real time.</p>
<p>See <a href="howto/./reference/api.html">API Reference</a> for a markdown rendered API reference.</p>
<h1><a class="header" href="#testing-clair" id="testing-clair">Testing Clair</a></h1>
<p>We provide dev tooling in order to quickly get a fully configured Clair and Quay environment stood up locally. This environment can be used to test and develop Clair.</p>
<h2><a class="header" href="#requirements" id="requirements">Requirements</a></h2>
<h3><a class="header" href="#make" id="make">Make</a></h3>
<p>Make is used to stand up the the local dev environment. 
Make is readily available in just about every package manager you can think of.
It's very likely your workstation already has make on it.</p>
<h3><a class="header" href="#docker-and-docker-compose" id="docker-and-docker-compose">Docker and Docker Compose</a></h3>
<p>Currently our local dev tooling is supported by docker and docker-compose. We are making strides to provide a podman native local dev environment but we are not quite there yet.</p>
<p>Docker version 19.03.11 and docker-compose version 1.25.4 are confirmed working. Our assumption is most recent versions will not have an issue running the local dev tooling.</p>
<p>See <a href="https://docs.docker.com/get-docker/">Install Docker</a></p>
<h3><a class="header" href="#go-toolchain" id="go-toolchain">Go Toolchain</a></h3>
<p>Go v1.13 or higher is required.</p>
<p>See <a href="https://golang.org/doc/install">Install Golang</a></p>
<h2><a class="header" href="#starting-a-cluster" id="starting-a-cluster">Starting a cluster</a></h2>
<pre><code>git clone git@github.com:quay/clair.git
cd clair
make local-dev-up-with-quay
</code></pre>
<p>After the local development environment successfully starts, the following infrastructure is available to you:</p>
<pre><code>localhost:8080 --- Quay (single node, local storage)

localhost:6060 --- Traefik which hosts all ClairV4 endpoints.
                   ClairV4 services are only accessible via this load balancer.

localhost:5432 --- ClairV4's Postgres DB
                   Login:
                      username: clair
                      database: clair

localhost:5433 --- Quay's Postgres DB
                   Login:
                     username: quay
                     database: quay

localhost:8082 --- OpenAPI Swagger Editor.
                   You can view ClairV4's public API here.

localhost:7000 --- Traefik Web UI.
                   Good for troubleshooting http issues.

localhost:9090 --- Prometheus
</code></pre>
<h2><a class="header" href="#pushing-to-the-local-quay" id="pushing-to-the-local-quay">Pushing to the Local Quay</a></h2>
<p>As mentioned above ,Quay is present at <code>localhost:8080</code>. You may navigate to this address and create a account. Creating an account named <code>admin</code> will ensure you are a super user. An email is required, but is not validated.</p>
<p>Once inside, you will create an organization named &quot;clairv4-org&quot;. Currently Quay has to explicitly enable Clair v4 security scanning, which is done via an organization allowlist. &quot;Clairv4-org&quot; is preconfigured in our local dev configuration.</p>
<p>The easiest way to push to Quay is using podman:</p>
<pre><code>podman pull ubuntu:latest
podman login --tls-verify=false localhost:8080 # use account created in above steps
podman tag ubuntu:latest localhost:8080/clairv4-org/testing:latest
podman push --tls-verify=false localhost:8080/clairv4-org/testing:latest
</code></pre>
<p>Using docker to push is possible, however you will need to add &quot;localhost:8080&quot; as an insecure repository. See <a href="https://docs.docker.com/registry/insecure/">Insecure Repository</a></p>
<h2><a class="header" href="#making-changes-to-configuration" id="making-changes-to-configuration">Making changes to configuration</a></h2>
<p>You may want to play with either Clair or Quay's configuration. 
If so, the configuration files can be found inside the repository at
<code>local-dev/quay/config.yaml</code> and <code>local-dev/clair.yaml</code>.</p>
<p>Any changes to the configs will require a restart of the relevant service. Take a look at the <code>Makefile</code> for the various restart targets.</p>
<h2><a class="header" href="#tearing-it-down" id="tearing-it-down">Tearing it down</a></h2>
<pre><code>make local-dev-down
</code></pre>
<p>will rip the entire environment down.</p>
<h2><a class="header" href="#troubleshooting" id="troubleshooting">Troubleshooting</a></h2>
<p>The most common issue encountered when standing up the dev environment is port conflicts. Make sure that you do not have any other processes listening on any of the ports outlined above.</p>
<p>The second issue you may face is your Docker resource settings maybe too constrained to support the local dev stack. This is typically seen on Docker4Mac since a VM is used with a specific set of resources configured. See <a href="https://docs.docker.com/docker-for-mac/">Docker For Mac Manual</a> for instructions on how to change these resources.</p>
<h1><a class="header" href="#concepts" id="concepts">Concepts</a></h1>
<p>The following sections give a conceptual overview of how Clair works internally.</p>
<ul>
<li><a href="./concepts/api_internal.html">Internal API</a></li>
<li><a href="./concepts/authentication.html">Authentication</a></li>
<li><a href="./concepts/notifications.html">Notifications</a></li>
<li><a href="./concepts/updatersandairgap.html">Updaters and Airgap</a></li>
</ul>
<h1><a class="header" href="#internal" id="internal">Internal</a></h1>
<p>Internal endpoints are underneath <code>/api/v1/internal</code> and are meant for
communication between Clair microservices. If Clair is operating in combo mode,
these endpoints may not exist. Any sort of API ingress should disallow clients
to talk to these endpoints.</p>
<p>We do not formally expose these APIs in our OpenAPI spec. 
Further information and usage is an effort left to the reader.</p>
<h2><a class="header" href="#updates-diffs" id="updates-diffs">Updates Diffs</a></h2>
<p>The <code>update_diff/</code> endpoint exposes the api for diffing two update operations. 
This is used by the notifier to determine the added and removed vulnerabilities on security databsae update.</p>
<h2><a class="header" href="#update-operation" id="update-operation">Update Operation</a></h2>
<p>The <code>update_operation</code> endpoint exposes the api for viewing updaters' activity. 
This is used by the notifier to determine if new updates have occured and triggers an update diff to see what has changed.</p>
<h2><a class="header" href="#affectedmanifest" id="affectedmanifest">AffectedManifest</a></h2>
<p>The <code>affected_manifest</code> endpoint exposes the api for retreiving affected manifests given a list of Vulnerabilities.
This is used by the notifier to determine the manifests that need to have a notification generated.</p>
<h1><a class="header" href="#authentication" id="authentication">Authentication</a></h1>
<p>Previous versions of Clair used <a href="https://github.com/quay/jwtproxy">jwtproxy</a> to gate authentication. For ease of
building and deployment, v4 handles authentication itself.</p>
<p>Authentication is configured by specifying configuration objects underneath the
<code>auth</code> key of the configuration. Multiple authentication configurations may be
present, but they will be used preferentially in the order laid out below.</p>
<h3><a class="header" href="#quay-integration" id="quay-integration">Quay Integration</a></h3>
<p>Quay implements a keyserver protocol that allows for publishing and rotating
keys in an automated fashion. Any process that has successfully enrolled in the
keyserver that Clair is configured to talk to should be able to sign requests to
Clair.</p>
<h4><a class="header" href="#configuration-1" id="configuration-1">Configuration</a></h4>
<p>The <code>auth</code> stanza of the configuration file requires one parameter, <code>api</code>, which
is the API endpoint of keyserver protocol.</p>
<pre><code class="language-yaml">auth:
  keyserver:
    api: 'https://quay.example.com/keys/'
</code></pre>
<h5><a class="header" href="#intraservice" id="intraservice">Intraservice</a></h5>
<p>When Clair instances are configured with keyserver authentication and run in any
other mode besides &quot;combo&quot;, an additional <code>intraservice</code> key is
required. This key is used for signing and verifying requests within the
Clair service cluster.</p>
<pre><code class="language-yaml">auth:
  keyserver:
    api: 'https://quay.example.com/keys/'
    intraservice: &gt;-
      MDQ4ODBlNDAtNDc0ZC00MWUxLThhMzAtOTk0MzEwMGQwYTMxCg==
</code></pre>
<h3><a class="header" href="#psk" id="psk">PSK</a></h3>
<p>Clair implements JWT-based authentication using a pre-shared key.</p>
<h4><a class="header" href="#configuration-2" id="configuration-2">Configuration</a></h4>
<p>The <code>auth</code> stanza of the configuration file requires two parameters: <code>iss</code>, which
is the issuer to validate on all incoming requests; and <code>key</code>, which is a base64
encoded symmetric key for validating the requests.</p>
<pre><code class="language-yaml">auth:
  psk:
    key: &gt;-
      MDQ4ODBlNDAtNDc0ZC00MWUxLThhMzAtOTk0MzEwMGQwYTMxCg==
    iss: 'issuer'
</code></pre>
<p>Desired updaters should be selected by the normal configuration mechanism.</p>
<h1><a class="header" href="#notifications-1" id="notifications-1">Notifications</a></h1>
<p>ClairV4 implements a notification system.</p>
<p>The notifier service will keep track of new security database updates and inform an interested client if new or removed vulnerabilites affect an indexed manifest.</p>
<p>The interested client can subscribe to notifications via several mechanisms:</p>
<ul>
<li>Webhook delivery</li>
<li>AMQP delivery</li>
<li>STOMP delivery</li>
</ul>
<p>Configuring the notifier is done via the yaml configuration. </p>
<p>See the &quot;Notifier&quot; object in our <a href="concepts/../reference/config.html">config reference</a></p>
<h2><a class="header" href="#a-notification" id="a-notification">A Notification</a></h2>
<p>When the notifier becomes aware of new vulnerabilities affecting a previously indexed manifest, it will use the configured method(s) to issue notifications about the new changes. Any given notification expresses the <strong>most severe</strong> vulnerability discovered because of the change. This avoids creating a flurry of notifications for the same security database update. </p>
<p>Once a client receives a notification, it should issue a new request against the <a href="concepts/../reference/matcher.html">matcher</a> to receive an up-to-date vulnerability report.</p>
<p>The notification schema is the JSON marshaled form of the following types:</p>
<pre><code class="language-go">// Reason indicates the catalyst for a notification
type Reason string
const (
	Added   Reason = &quot;added&quot;
	Removed Reason = &quot;removed&quot;
	Changed Reason = &quot;changed&quot;
)
type Notification struct {
	ID            uuid.UUID        `json:&quot;id&quot;`
	Manifest      claircore.Digest `json:&quot;manifest&quot;`
	Reason        Reason           `json:&quot;reason&quot;`
	Vulnerability VulnSummary      `json:&quot;vulnerability&quot;`
}
type VulnSummary struct {
	Name           string                  `json:&quot;name&quot;`
	Description    string                  `json:&quot;description&quot;`
	Package        *claircore.Package      `json:&quot;package,omitempty&quot;`
	Distribution   *claircore.Distribution `json:&quot;distribution,omitempty&quot;`
	Repo           *claircore.Repository   `json:&quot;repo,omitempty&quot;`
	Severity       string                  `json:&quot;severity&quot;`
	FixedInVersion string                  `json:&quot;fixed_in_version&quot;`
	Links          string                  `json:&quot;links&quot;`
}
</code></pre>
<h2><a class="header" href="#webhook-delivery" id="webhook-delivery">Webhook Delivery</a></h2>
<p><em>See the &quot;Notifier.Webhook&quot; object in the <a href="concepts/../reference/config.html">config reference</a> for complete configuration details.</em></p>
<p>When you configure notifier for webhook delivery you provide the service with the following pieces of information:</p>
<ul>
<li>A target URL where the webhook will fire</li>
<li>The callback URL where the notifier may be reached including its API path
<ul>
<li>e.g. &quot;http://clair-notifier/api/v1/notifications&quot;</li>
</ul>
</li>
</ul>
<p>When the notifier has determined an updated security database has changed the affected status of an indexed manifest, it will deliver the following JSON body to the configured target:</p>
<pre><code class="language-json">{
  &quot;notifiction_id&quot;: {uuid_string},
  &quot;callback&quot;: {url_to_notifications}
}
</code></pre>
<p>On receipt, the server can immediately browse to the URL provided in the callback field.</p>
<h3><a class="header" href="#pagination" id="pagination">Pagination</a></h3>
<p>The URL returned in the callback field brings the client to a paginated result.</p>
<p>The callback endpoint specification follows:</p>
<pre><code class="language-go">GET /api/v1/notification/{id}?[page_size=N][next=N]
{
  page: {
    size:    int,      // maximum number of notifications in the response 
    next:   string, //  if present, the next id to fetch.
  }
  notifications: [ Notification… ] // array of notifications; max len == page.size
}
</code></pre>
<p>The GET callback request implements a simple bare-minimum paging mechanism.</p>
<p>The &quot;page_size&quot; url param controls how many notifications are returned in a single page. 
If not provided a default of 500 is used.</p>
<p>The &quot;next&quot; url param informs Clair the next set of paged notifications to return. If not provided the 0th page is assumed.</p>
<p>A page object accompanying the notification list specifies &quot;next&quot; and &quot;size&quot; fields.</p>
<p>The &quot;next&quot; field returned in the page must be provided as the subsequent request's &quot;next&quot; url parameter to retrieve the next set of notifications.</p>
<p>The &quot;size&quot; field will simply echo back the request page_size parameter.</p>
<p>When the final page is served to the client the returned &quot;page&quot; data structure will not contain a &quot;next&quot; member.</p>
<p>Therefore the following loop is valid for obtaining all notifications for a notification id in pages of a specified size.</p>
<pre><code>{ page, notifications } = http.Get(&quot;http://clairv4/api/v1/notifications/{id}?page_size=1000&quot;)

while (page.Next != None) {
    { page, notifications } = http.Get(&quot;http://clairv4/api/v1/notifications/{id}?next={page.Next},page_size=1000&quot;)
}
</code></pre>
<p><em>Note: If the client specifies a custom page_size it must specify this page_size on every request for accurate responses.</em></p>
<h3><a class="header" href="#deleting-notifications" id="deleting-notifications">Deleting Notifications</a></h3>
<p>While not mandatory, the client may issue a delete of the notification via a DELETE method. See <a href="concepts/../howto/api.html">api</a> to view the delete api.</p>
<p>Deleting a notification ID will clean up resources in the notifier quicker. Otherwise the notifier will wait a predetermined length of time before clearing delivered notifications from its database.</p>
<h2><a class="header" href="#amqp-delivery" id="amqp-delivery">AMQP Delivery</a></h2>
<p><em>See the &quot;Notifier.AMQP&quot; object in our <a href="concepts/../reference/config.html">config reference</a> for complete configuration details.</em></p>
<p>The notifier also supports delivering to an AMQP broker. With AMQP delivery you can control whether a callback is delivered to the broker or whether notifications are directly delivered to the queue.</p>
<p>This allows the developer of the AMQP consumer to determine the logic of notification processing.</p>
<h3><a class="header" href="#direct-delivery" id="direct-delivery">Direct Delivery</a></h3>
<p>If the notifier's configuration specifies <code>direct: true</code> for AMQP, notifications will be delivered directly to the configured exchange.</p>
<p>When <code>direct</code> is set, the <code>rollup</code> property may be set to instruct the notifier to send a max number of notifications in a single AMQP message. This allows a balance between size of the message and number of messages delivered to the queue.</p>
<h2><a class="header" href="#testing-and-development" id="testing-and-development">Testing and Development</a></h2>
<p>The notifier has a testing mode enabled when it sees the &quot;NOTIFIER_TEST_MODE&quot; environment variable set. It can be set to any value as we only check to see if it exists.</p>
<p>When this environment variable is set, the notifier will begin sending fake notifications to the configured delivery mechanism every &quot;poll_interval&quot; interval. This provides an easy way to implement and test new or existing deliverers.</p>
<p>The notifier will run in this mode until the environment variable is cleared and the service is restarted.</p>
<h2><a class="header" href="#updaters" id="updaters">Updaters</a></h2>
<p>Clair utilizes go packages we call &quot;updaters&quot; that encapsulate the logic of
fetching and parsing different vulnerability databases. Updaters are usually
pared with a matcher to interpret if and how any vulnerability is related to a
package.</p>
<p>Operators may wish to update the vulnerability database less frequently or not
import vulnerabilities from databases that they know will not be used.</p>
<h3><a class="header" href="#configuration-3" id="configuration-3">Configuration</a></h3>
<p>Updaters can be configured by <code>updaters</code> key at the top of the configuration. If
updaters are being run automatically within the matcher processes, as is the
default, the period for running updaters is configured under the matcher's
configuration stanza.</p>
<h4><a class="header" href="#choosing-sets" id="choosing-sets">Choosing Sets</a></h4>
<p>Specific sets of updaters can be selected by the <code>sets</code> list. If not present,
the defaults of all upstream updaters will be used.</p>
<pre><code class="language-yaml">updaters:
  sets:
    - rhel
</code></pre>
<h4><a class="header" href="#filtering-updaters" id="filtering-updaters">Filtering Updaters</a></h4>
<p>To disallow an updater from running without disabling an entire set, the filter
option can be used. The provided string will be interpreted as a go [regexp]
used to disallow any updater with a name that does not match. <strong>Note:</strong> This
means that an empty string matches <em>any</em> string, not no strings.</p>
<pre><code class="language-yaml">updaters:
  filter: '^$'
</code></pre>
<h4><a class="header" href="#specific-updaters" id="specific-updaters">Specific Updaters</a></h4>
<p>Configuration for specific updaters can be passed by putting a key underneath
the <code>config</code> member of the <code>updaters</code> object. The name of an updater may be
constructed dynamically; users should examine logs to double-check names.
The specific object that an updater expects should be covered in the updater's
documentation.</p>
<p>For example, to have the &quot;rhel&quot; updater fetch a manifest from a different
location:</p>
<pre><code class="language-yaml">updaters:
  config:
    rhel:
      url: https://example.com/mirror/oval/PULP_MANIFEST
</code></pre>
<h3><a class="header" href="#airgap" id="airgap">Airgap</a></h3>
<p>For additional flexibility, Clair supports running updaters in a different
environment and importing the results. This is aimed at supporting installations
that disallow the Clair cluster from talking to the Internet directly. An update
procedure needs to arrange to call the relevant <code>clairctl</code> command in an
environment with access to the Internet, move the resulting artifact across the
airgap according to site policy, and then call the relevant <code>clairctl</code> command
to import the updates.</p>
<p>For example:</p>
<pre><code class="language-sh"># On a workstation, run:
clairctl updater-export updates.gz
</code></pre>
<pre><code class="language-sh"># Move the resulting file to a place reachable by the cluster:
scp updates.gz internal-webserver:/var/www/
</code></pre>
<pre><code class="language-sh"># On a pod inside the cluster, import the file:
clairctl updater-import http://web.svc/updates.gz
</code></pre>
<h4><a class="header" href="#configuration-4" id="configuration-4">Configuration</a></h4>
<p>Matcher processes should have the <code>disable_updaters</code> key set to disable
automatic updaters running.</p>
<pre><code class="language-yaml">matcher:
  disable_updaters: true
</code></pre>
<h2><a class="header" href="#indexers" id="indexers">Indexers</a></h2>
<h3><a class="header" href="#configuration-5" id="configuration-5">Configuration</a></h3>
<h4><a class="header" href="#airgap-1" id="airgap-1">Airgap</a></h4>
<pre><code class="language-yaml">indexer:
  airgap: true
</code></pre>
<h4><a class="header" href="#specific-scanners" id="specific-scanners">Specific Scanners</a></h4>
<pre><code class="language-yaml">indexer:
  scanner:
    package:
      name:
        key: value
    repo:
      name:
        key: value
    dist:
      name:
        key: value
</code></pre>
<h1><a class="header" href="#contribuion" id="contribuion">Contribuion</a></h1>
<p>The following sections provides information on how to contribute to Clair.</p>
<ul>
<li><a href="./contribution/commit_style.html">Commit Style</a></li>
<li><a href="./contribution/releases.html">Releases</a></li>
</ul>
<h1><a class="header" href="#releases-1" id="releases-1">Releases</a></h1>
<p>Clair releases are cut roughly every three months and actively maintained for
six.</p>
<p>This means that bugfixes should be landed on <code>master</code> (if applicable) and then
marked for backporting to a minor version's release branch. The process for
doing this is not yet formalized.</p>
<h2><a class="header" href="#process" id="process">Process</a></h2>
<h3><a class="header" href="#minor" id="minor">Minor</a></h3>
<p>When cutting a new minor release, two things need to be done: creating a tag and
creating a release branch. This can be done like so:</p>
<pre><code class="language-sh">git tag -as v4.x.0 HEAD
git push upstream HEAD:release-4.x tag v4.x.0
</code></pre>
<p>Then, a &quot;release&quot; needs to be created in the Github UI using the created tag.</p>
<h3><a class="header" href="#patch" id="patch">Patch</a></h3>
<p>A patch release is just like a minor release with the caveat that minor version
tags should <em>only</em> appear on release branches and a new branch does not need to
be created.</p>
<pre><code class="language-sh">git checkout release-4.x
git tag -as v4.x.1 HEAD
git push upstream tag v4.x.1
</code></pre>
<p>Then, a &quot;release&quot; needs to be created in the Github UI using the created tag.</p>
<h3><a class="header" href="#creating-artifacts" id="creating-artifacts">Creating Artifacts</a></h3>
<p>Clair's artifact release process is automated and driven off the releases in
Github.</p>
<p>Publishing a new release in the Github UI automatically triggers the creation of
a complete source archive and a container. The archive is attached to the
release, and the container is pushed to the
<a href="https://quay.io/repository/projectquay/clair"><code>quay.io/projectquay/clair</code></a>
repository.</p>
<p>This is all powered by a Github Action in <code>.github/workflows/cut-release.yml</code>.</p>
<h1><a class="header" href="#commit-style" id="commit-style">Commit Style</a></h1>
<p>The Clair project utilizes well structured commits to keep the history useful and help with release automation.
We suggest signing off on your commits as well.</p>
<p>A typical commit will take on the following structure:</p>
<pre><code>&lt;scope&gt;: &lt;subject&gt;

&lt;body&gt;
Fixes #1
Pull Request #2

Signed-Off By: &lt;email&gt;
</code></pre>
<p>The header of the commit is regexp checked before commit and your commit will be kicked back if it does not conform.</p>
<h2><a class="header" href="#scope" id="scope">Scope</a></h2>
<p>This is the section of code this commit influences. </p>
<p>You will often see scopes such as &quot;notifier&quot;, &quot;auth&quot;, &quot;chore&quot;, &quot;cicd&quot;.</p>
<p>We use this field to group commits by scope in our automated changelog generation.</p>
<p>It would be wise to take a look at our changelog before contributing to get an idea of the common scopes we use.</p>
<h2><a class="header" href="#subject" id="subject">Subject</a></h2>
<p>Subject is a short and concise summary of the change the commit is introducing. It should be a sentence fragment without starting capitalization and ending punctuation and limited to about 60 characters, to allow for the scope prefix and decoration in the git log.</p>
<h2><a class="header" href="#body" id="body">Body</a></h2>
<p>Body should be full of detail.</p>
<p>Explain what this commit is doing and why it is necessary.</p>
<p>You may include references to issues and pull requests as well. Our automated changelog process will discover references prefixed with &quot;Fixes&quot;, &quot;Closed&quot; and &quot;Pull Request&quot;</p>
<h1><a class="header" href="#reference" id="reference">Reference</a></h1>
<p>The following sections provide reference information useful when exploring the documentation or working with Clair directly.</p>
<ul>
<li><a href="./reference/api.html">API</a></li>
<li><a href="./reference/clairctl.html">Clairctl</a></li>
<li><a href="./reference/config.html">Config</a></li>
<li><a href="./reference/indexer.html">Indexer</a></li>
<li><a href="./reference/matcher.html">Matcher</a></li>
<li><a href="./reference/notifier.html">Notifier</a></li>
</ul>
<hr />
<p>title: ClairV4 v0.1
language_tabs:</p>
<ul>
<li>python: Python</li>
<li>go: Golang</li>
<li>javascript: Javascript
language_clients:</li>
<li>python: &quot;&quot;</li>
<li>go: &quot;&quot;</li>
<li>javascript: &quot;&quot;
toc_footers: []
includes: []
search: false
highlight_theme: darkula
headingLevel: 2</li>
</ul>
<hr />
<!-- Generator: Widdershins v4.0.1 -->
<h1 id="clairv4">ClairV4 v0.1</h1>
<blockquote>
<p>Scroll down for code samples, example requests and responses. Select a language for code samples from the tabs above or the mobile navigation menu.</p>
</blockquote>
<p>ClairV4 is a set of cooperating microservices which scan, index, and
match your container's content with known vulnerabilities.</p>
<p>Email: <a href="mailto:quay-devel@redhat.com">Clair Team</a> Web: <a href="http://github.com/quay/clair">Clair Team</a> 
License: <a href="http://www.apache.org/licenses/">Apache License 2.0</a></p>
<h1 id="clairv4-notifier">Notifier</h1>
<h2><a class="header" href="#notifications-delete" id="notifications-delete">notifications delete</a></h2>
<p><a id="opIdnotifications delete"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/json'
}

r = requests.delete('/api/v1/notification/{notification_id}', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       &quot;bytes&quot;
       &quot;net/http&quot;
)

func main() {

    headers := map[string][]string{
        &quot;Accept&quot;: []string{&quot;application/json&quot;},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest(&quot;DELETE&quot;, &quot;/api/v1/notification/{notification_id}&quot;, data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/json'
};

fetch('/api/v1/notification/{notification_id}',
{
  method: 'DELETE',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>DELETE /api/v1/notification/{notification_id}</code></p>
<p>Issues a delete of the provided notification id and all associated notifications.
After this delete clients will no longer be able to retrieve notifications.</p>
<h3 id="notifications-delete-parameters">Parameters</h3>
<table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>notification_id</td><td>path</td><td>string</td><td>false</td><td>A notification ID returned by a callback</td></tr>
</tbody></table>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">null
</code></pre>
<h3 id="notifications-delete-responses">Responses</h3>
<table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>OK</td><td>Inline</td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>405</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.5">Method Not Allowed</a></td><td>Method Not Allowed</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>500</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.6.1">Internal Server Error</a></td><td>Internal Server Error</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
</tbody></table>
<h3 id="notifications-delete-responseschema">Response Schema</h3>
<aside class="success">
This operation does not require authentication
</aside>
<h2><a class="header" href="#retreive-a-paginated-result-of-notifications-for-the-provided-id" id="retreive-a-paginated-result-of-notifications-for-the-provided-id">Retreive a paginated result of notifications for the provided id</a></h2>
<p><a id="opIdnotifications get"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/json'
}

r = requests.get('/api/v1/notification/{notification_id}', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       &quot;bytes&quot;
       &quot;net/http&quot;
)

func main() {

    headers := map[string][]string{
        &quot;Accept&quot;: []string{&quot;application/json&quot;},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest(&quot;GET&quot;, &quot;/api/v1/notification/{notification_id}&quot;, data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/json'
};

fetch('/api/v1/notification/{notification_id}',
{
  method: 'GET',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>GET /api/v1/notification/{notification_id}</code></p>
<p>By performing a GET with a notification_id as a path parameter the client
will retrieve a paginated response of notifcation objects</p>
<h3 id="retreive-a-paginated-result-of-notifications-for-the-provided-id-parameters">Parameters</h3>
<table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>notification_id</td><td>path</td><td>string</td><td>false</td><td>A notification ID returned by a callback</td></tr>
<tr><td>page_size</td><td>query</td><td>int</td><td>false</td><td>The maximum number of notifications to deliver in a single page.</td></tr>
<tr><td>next</td><td>query</td><td>string</td><td>false</td><td>The next page to fetch via id. Typically this number is provided to you</td></tr>
</tbody></table>
<h4><a class="header" href="#detailed-descriptions" id="detailed-descriptions">Detailed descriptions</a></h4>
<p><strong>next</strong>: The next page to fetch via id. Typically this number is provided to you 
on initial response in the page.next field.
The first GET request may omit this field.</p>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">{
  &quot;page&quot;: {
    &quot;size&quot;: 100,
    &quot;next&quot;: &quot;1b4d0db2-e757-4150-bbbb-543658144205&quot;
  },
  &quot;notifications&quot;: [
    {
      &quot;id&quot;: &quot;5e4b387e-88d3-4364-86fd-063447a6fad2&quot;,
      &quot;manifest&quot;: &quot;sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a&quot;,
      &quot;reason&quot;: &quot;added&quot;,
      &quot;vulnerability&quot;: {
        &quot;name&quot;: &quot;CVE-2009-5155&quot;,
        &quot;fixed_in_version&quot;: &quot;v0.0.1&quot;,
        &quot;links&quot;: &quot;http://link-to-advisory&quot;,
        &quot;description&quot;: &quot;In the GNU C Library (aka glibc or libc6) before 2.28,\nparse_reg_exp in posix/regcomp.c misparses alternatives,\nwhich allows attackers to cause a denial of service (assertion\nfailure and application exit) or trigger an incorrect result\nby attempting a regular-expression match.\&quot;\n&quot;,
        &quot;normalized_severity&quot;: &quot;Unknown&quot;,
        &quot;package&quot;: {
          &quot;id&quot;: &quot;10&quot;,
          &quot;name&quot;: &quot;libapt-pkg5.0&quot;,
          &quot;version&quot;: &quot;1.6.11&quot;,
          &quot;kind&quot;: &quot;binary&quot;,
          &quot;normalized_version&quot;: &quot;&quot;,
          &quot;arch&quot;: &quot;x86&quot;,
          &quot;module&quot;: &quot;&quot;,
          &quot;cpe&quot;: &quot;&quot;,
          &quot;source&quot;: {
            &quot;id&quot;: &quot;9&quot;,
            &quot;name&quot;: &quot;apt&quot;,
            &quot;version&quot;: &quot;1.6.11&quot;,
            &quot;kind&quot;: &quot;source&quot;,
            &quot;source&quot;: null
          }
        },
        &quot;distribution&quot;: {
          &quot;id&quot;: &quot;1&quot;,
          &quot;did&quot;: &quot;ubuntu&quot;,
          &quot;name&quot;: &quot;Ubuntu&quot;,
          &quot;version&quot;: &quot;18.04.3 LTS (Bionic Beaver)&quot;,
          &quot;version_code_name&quot;: &quot;bionic&quot;,
          &quot;version_id&quot;: &quot;18.04&quot;,
          &quot;arch&quot;: &quot;&quot;,
          &quot;cpe&quot;: &quot;&quot;,
          &quot;pretty_name&quot;: &quot;Ubuntu 18.04.3 LTS&quot;
        },
        &quot;repository&quot;: {
          &quot;id&quot;: &quot;string&quot;,
          &quot;name&quot;: &quot;string&quot;,
          &quot;key&quot;: &quot;string&quot;,
          &quot;uri&quot;: &quot;string&quot;,
          &quot;cpe&quot;: &quot;string&quot;
        }
      }
    }
  ]
}
</code></pre>
<h3 id="retreive-a-paginated-result-of-notifications-for-the-provided-id-responses">Responses</h3>
<table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>A paginated list of notifications</td><td><a href="reference/api.html#schemapagednotifications">PagedNotifications</a></td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>405</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.5">Method Not Allowed</a></td><td>Method Not Allowed</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>500</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.6.1">Internal Server Error</a></td><td>Internal Server Error</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
</tbody></table>
<aside class="success">
This operation does not require authentication
</aside>
<h1 id="clairv4-indexer">Indexer</h1>
<h2><a class="header" href="#index-the-contents-of-a-manifest" id="index-the-contents-of-a-manifest">Index the contents of a Manifest</a></h2>
<p><a id="opIdIndex"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Content-Type': 'application/json',
  'Accept': 'application/json'
}

r = requests.post('/api/v1/index_report', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       &quot;bytes&quot;
       &quot;net/http&quot;
)

func main() {

    headers := map[string][]string{
        &quot;Content-Type&quot;: []string{&quot;application/json&quot;},
        &quot;Accept&quot;: []string{&quot;application/json&quot;},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest(&quot;POST&quot;, &quot;/api/v1/index_report&quot;, data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">const inputBody = '{
  &quot;hash&quot;: &quot;sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3&quot;,
  &quot;layers&quot;: [
    {
      &quot;hash&quot;: &quot;sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3&quot;,
      &quot;uri&quot;: &quot;https://storage.example.com/blob/2f077db56abccc19f16f140f629ae98e904b4b7d563957a7fc319bd11b82ba36\n&quot;,
      &quot;headers&quot;: {
        &quot;property1&quot;: [
          &quot;string&quot;
        ],
        &quot;property2&quot;: [
          &quot;string&quot;
        ]
      }
    }
  ]
}';
const headers = {
  'Content-Type':'application/json',
  'Accept':'application/json'
};

fetch('/api/v1/index_report',
{
  method: 'POST',
  body: inputBody,
  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>POST /api/v1/index_report</code></p>
<p>By submitting a Manifest object to this endpoint Clair will fetch the
layers, scan each layer's contents, and provide an index of discovered
packages, repository and distribution information.</p>
<blockquote>
<p>Body parameter</p>
</blockquote>
<pre><code class="language-json">{
  &quot;hash&quot;: &quot;sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3&quot;,
  &quot;layers&quot;: [
    {
      &quot;hash&quot;: &quot;sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3&quot;,
      &quot;uri&quot;: &quot;https://storage.example.com/blob/2f077db56abccc19f16f140f629ae98e904b4b7d563957a7fc319bd11b82ba36\n&quot;,
      &quot;headers&quot;: {
        &quot;property1&quot;: [
          &quot;string&quot;
        ],
        &quot;property2&quot;: [
          &quot;string&quot;
        ]
      }
    }
  ]
}
</code></pre>
<h3 id="index-the-contents-of-a-manifest-parameters">Parameters</h3>
<table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>body</td><td>body</td><td><a href="reference/api.html#schemamanifest">Manifest</a></td><td>true</td><td>none</td></tr>
</tbody></table>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>201 Response</p>
</blockquote>
<pre><code class="language-json">{
  &quot;manifest_hash&quot;: &quot;sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3&quot;,
  &quot;state&quot;: &quot;IndexFinished&quot;,
  &quot;packages&quot;: {
    &quot;10&quot;: {
      &quot;id&quot;: &quot;10&quot;,
      &quot;name&quot;: &quot;libapt-pkg5.0&quot;,
      &quot;version&quot;: &quot;1.6.11&quot;,
      &quot;kind&quot;: &quot;binary&quot;,
      &quot;normalized_version&quot;: &quot;&quot;,
      &quot;arch&quot;: &quot;x86&quot;,
      &quot;module&quot;: &quot;&quot;,
      &quot;cpe&quot;: &quot;&quot;,
      &quot;source&quot;: {
        &quot;id&quot;: &quot;9&quot;,
        &quot;name&quot;: &quot;apt&quot;,
        &quot;version&quot;: &quot;1.6.11&quot;,
        &quot;kind&quot;: &quot;source&quot;,
        &quot;source&quot;: null
      }
    }
  },
  &quot;distributions&quot;: {
    &quot;1&quot;: {
      &quot;id&quot;: &quot;1&quot;,
      &quot;did&quot;: &quot;ubuntu&quot;,
      &quot;name&quot;: &quot;Ubuntu&quot;,
      &quot;version&quot;: &quot;18.04.3 LTS (Bionic Beaver)&quot;,
      &quot;version_code_name&quot;: &quot;bionic&quot;,
      &quot;version_id&quot;: &quot;18.04&quot;,
      &quot;arch&quot;: &quot;&quot;,
      &quot;cpe&quot;: &quot;&quot;,
      &quot;pretty_name&quot;: &quot;Ubuntu 18.04.3 LTS&quot;
    }
  },
  &quot;environments&quot;: {
    &quot;10&quot;: [
      {
        &quot;package_db&quot;: &quot;var/lib/dpkg/status&quot;,
        &quot;introduced_in&quot;: &quot;sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a&quot;,
        &quot;distribution_id&quot;: &quot;1&quot;
      }
    ]
  },
  &quot;success&quot;: true,
  &quot;err&quot;: &quot;&quot;
}
</code></pre>
<h3 id="index-the-contents-of-a-manifest-responses">Responses</h3>
<table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>201</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.2">Created</a></td><td>IndexReport Created</td><td><a href="reference/api.html#schemaindexreport">IndexReport</a></td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>405</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.5">Method Not Allowed</a></td><td>Method Not Allowed</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>500</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.6.1">Internal Server Error</a></td><td>Internal Server Error</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
</tbody></table>
<aside class="success">
This operation does not require authentication
</aside>
<h2><a class="header" href="#retrieve-an-indexreport-for-the-given-manifest-hash-if-exists" id="retrieve-an-indexreport-for-the-given-manifest-hash-if-exists">Retrieve an IndexReport for the given Manifest hash if exists.</a></h2>
<p><a id="opIdGetIndexReport"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/json'
}

r = requests.get('/api/v1/index_report/{manifest_hash}', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       &quot;bytes&quot;
       &quot;net/http&quot;
)

func main() {

    headers := map[string][]string{
        &quot;Accept&quot;: []string{&quot;application/json&quot;},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest(&quot;GET&quot;, &quot;/api/v1/index_report/{manifest_hash}&quot;, data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/json'
};

fetch('/api/v1/index_report/{manifest_hash}',
{
  method: 'GET',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>GET /api/v1/index_report/{manifest_hash}</code></p>
<p>Given a Manifest's content addressable hash an IndexReport will
be retrieved if exists.</p>
<h3 id="retrieve-an-indexreport-for-the-given-manifest-hash-if-exists.-parameters">Parameters</h3>
<table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>manifest_hash</td><td>path</td><td><a href="reference/api.html#schemadigest">Digest</a></td><td>true</td><td>A digest of a manifest that has been indexed previous to this</td></tr>
</tbody></table>
<h4><a class="header" href="#detailed-descriptions-1" id="detailed-descriptions-1">Detailed descriptions</a></h4>
<p><strong>manifest_hash</strong>: A digest of a manifest that has been indexed previous to this
request.</p>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">{
  &quot;manifest_hash&quot;: &quot;sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3&quot;,
  &quot;state&quot;: &quot;IndexFinished&quot;,
  &quot;packages&quot;: {
    &quot;10&quot;: {
      &quot;id&quot;: &quot;10&quot;,
      &quot;name&quot;: &quot;libapt-pkg5.0&quot;,
      &quot;version&quot;: &quot;1.6.11&quot;,
      &quot;kind&quot;: &quot;binary&quot;,
      &quot;normalized_version&quot;: &quot;&quot;,
      &quot;arch&quot;: &quot;x86&quot;,
      &quot;module&quot;: &quot;&quot;,
      &quot;cpe&quot;: &quot;&quot;,
      &quot;source&quot;: {
        &quot;id&quot;: &quot;9&quot;,
        &quot;name&quot;: &quot;apt&quot;,
        &quot;version&quot;: &quot;1.6.11&quot;,
        &quot;kind&quot;: &quot;source&quot;,
        &quot;source&quot;: null
      }
    }
  },
  &quot;distributions&quot;: {
    &quot;1&quot;: {
      &quot;id&quot;: &quot;1&quot;,
      &quot;did&quot;: &quot;ubuntu&quot;,
      &quot;name&quot;: &quot;Ubuntu&quot;,
      &quot;version&quot;: &quot;18.04.3 LTS (Bionic Beaver)&quot;,
      &quot;version_code_name&quot;: &quot;bionic&quot;,
      &quot;version_id&quot;: &quot;18.04&quot;,
      &quot;arch&quot;: &quot;&quot;,
      &quot;cpe&quot;: &quot;&quot;,
      &quot;pretty_name&quot;: &quot;Ubuntu 18.04.3 LTS&quot;
    }
  },
  &quot;environments&quot;: {
    &quot;10&quot;: [
      {
        &quot;package_db&quot;: &quot;var/lib/dpkg/status&quot;,
        &quot;introduced_in&quot;: &quot;sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a&quot;,
        &quot;distribution_id&quot;: &quot;1&quot;
      }
    ]
  },
  &quot;success&quot;: true,
  &quot;err&quot;: &quot;&quot;
}
</code></pre>
<h3 id="retrieve-an-indexreport-for-the-given-manifest-hash-if-exists.-responses">Responses</h3>
<table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>IndexReport retrieved</td><td><a href="reference/api.html#schemaindexreport">IndexReport</a></td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>404</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.4">Not Found</a></td><td>Not Found</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>405</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.5">Method Not Allowed</a></td><td>Method Not Allowed</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>500</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.6.1">Internal Server Error</a></td><td>Internal Server Error</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
</tbody></table>
<aside class="success">
This operation does not require authentication
</aside>
<h2><a class="header" href="#report-the-indexers-internal-configuration-and-state" id="report-the-indexers-internal-configuration-and-state">Report the indexer's internal configuration and state.</a></h2>
<p><a id="opIdIndexState"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/json'
}

r = requests.get('/api/v1/index_state', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       &quot;bytes&quot;
       &quot;net/http&quot;
)

func main() {

    headers := map[string][]string{
        &quot;Accept&quot;: []string{&quot;application/json&quot;},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest(&quot;GET&quot;, &quot;/api/v1/index_state&quot;, data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/json'
};

fetch('/api/v1/index_state',
{
  method: 'GET',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>GET /api/v1/index_state</code></p>
<p>The index state endpoint returns a json structure indicating the
indexer's internal configuration state.</p>
<p>A client may be interested in this as a signal that manifests may need
to be re-indexed.</p>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">{
  &quot;state&quot;: &quot;aae368a064d7c5a433d0bf2c4f5554cc&quot;
}
</code></pre>
<h3 id="report-the-indexer's-internal-configuration-and-state.-responses">Responses</h3>
<table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>Indexer State</td><td><a href="reference/api.html#schemastate">State</a></td></tr>
<tr><td>304</td><td><a href="https://tools.ietf.org/html/rfc7232#section-4.1">Not Modified</a></td><td>Indexer State Unchanged</td><td>None</td></tr>
</tbody></table>
<h3><a class="header" href="#response-headers" id="response-headers">Response Headers</a></h3>
<table><thead><tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>200</td><td>Etag</td><td>string</td><td></td><td>Entity Tag</td></tr>
</tbody></table>
<aside class="success">
This operation does not require authentication
</aside>
<h1 id="clairv4-matcher">Matcher</h1>
<h2><a class="header" href="#retrieve-a-vulnerabilityreport-for-a-given-manifests-content" id="retrieve-a-vulnerabilityreport-for-a-given-manifests-content">Retrieve a VulnerabilityReport for a given manifest's content</a></h2>
<p>addressable hash.</p>
<p><a id="opIdGetVulnerabilityReport"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/json'
}

r = requests.get('/api/v1/vulnerability_report/{manifest_hash}', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       &quot;bytes&quot;
       &quot;net/http&quot;
)

func main() {

    headers := map[string][]string{
        &quot;Accept&quot;: []string{&quot;application/json&quot;},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest(&quot;GET&quot;, &quot;/api/v1/vulnerability_report/{manifest_hash}&quot;, data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/json'
};

fetch('/api/v1/vulnerability_report/{manifest_hash}',
{
  method: 'GET',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>GET /api/v1/vulnerability_report/{manifest_hash}</code></p>
<p>Given a Manifest's content addressable hash a VulnerabilityReport
will be created. The Manifest <strong>must</strong> have been Indexed first
via the Index endpoint.</p>
<h3 id="retrieve-a-vulnerabilityreport-for-a-given-manifest's-content
addressable-hash.
-parameters">Parameters</h3>
<table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>manifest_hash</td><td>path</td><td><a href="reference/api.html#schemadigest">Digest</a></td><td>true</td><td>A digest of a manifest that has been indexed previous to this</td></tr>
</tbody></table>
<h4><a class="header" href="#detailed-descriptions-2" id="detailed-descriptions-2">Detailed descriptions</a></h4>
<p><strong>manifest_hash</strong>: A digest of a manifest that has been indexed previous to this
request.</p>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>201 Response</p>
</blockquote>
<pre><code class="language-json">{
  &quot;manifest_hash&quot;: &quot;sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3&quot;,
  &quot;packages&quot;: {
    &quot;10&quot;: {
      &quot;id&quot;: &quot;10&quot;,
      &quot;name&quot;: &quot;libapt-pkg5.0&quot;,
      &quot;version&quot;: &quot;1.6.11&quot;,
      &quot;kind&quot;: &quot;binary&quot;,
      &quot;normalized_version&quot;: &quot;&quot;,
      &quot;arch&quot;: &quot;x86&quot;,
      &quot;module&quot;: &quot;&quot;,
      &quot;cpe&quot;: &quot;&quot;,
      &quot;source&quot;: {
        &quot;id&quot;: &quot;9&quot;,
        &quot;name&quot;: &quot;apt&quot;,
        &quot;version&quot;: &quot;1.6.11&quot;,
        &quot;kind&quot;: &quot;source&quot;,
        &quot;source&quot;: null
      }
    }
  },
  &quot;distributions&quot;: {
    &quot;1&quot;: {
      &quot;id&quot;: &quot;1&quot;,
      &quot;did&quot;: &quot;ubuntu&quot;,
      &quot;name&quot;: &quot;Ubuntu&quot;,
      &quot;version&quot;: &quot;18.04.3 LTS (Bionic Beaver)&quot;,
      &quot;version_code_name&quot;: &quot;bionic&quot;,
      &quot;version_id&quot;: &quot;18.04&quot;,
      &quot;arch&quot;: &quot;&quot;,
      &quot;cpe&quot;: &quot;&quot;,
      &quot;pretty_name&quot;: &quot;Ubuntu 18.04.3 LTS&quot;
    }
  },
  &quot;environments&quot;: {
    &quot;10&quot;: [
      {
        &quot;package_db&quot;: &quot;var/lib/dpkg/status&quot;,
        &quot;introduced_in&quot;: &quot;sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a&quot;,
        &quot;distribution_id&quot;: &quot;1&quot;
      }
    ]
  },
  &quot;vulnerabilities&quot;: {
    &quot;356835&quot;: {
      &quot;id&quot;: &quot;356835&quot;,
      &quot;updater&quot;: &quot;&quot;,
      &quot;name&quot;: &quot;CVE-2009-5155&quot;,
      &quot;description&quot;: &quot;In the GNU C Library (aka glibc or libc6) before 2.28,\nparse_reg_exp in posix/regcomp.c misparses alternatives,\nwhich allows attackers to cause a denial of service (assertion\nfailure and application exit) or trigger an incorrect result\nby attempting a regular-expression match.\&quot;\n&quot;,
      &quot;links&quot;: &quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-5155\nhttp://people.canonical.com/~ubuntu-security/cve/2009/CVE-2009-5155.html\nhttps://sourceware.org/bugzilla/show_bug.cgi?id=11053\nhttps://debbugs.gnu.org/cgi/bugreport.cgi?bug=22793\nhttps://debbugs.gnu.org/cgi/bugreport.cgi?bug=32806\nhttps://debbugs.gnu.org/cgi/bugreport.cgi?bug=34238\nhttps://sourceware.org/bugzilla/show_bug.cgi?id=18986\&quot;\n&quot;,
      &quot;severity&quot;: &quot;Low&quot;,
      &quot;normalized_severity&quot;: &quot;Low&quot;,
      &quot;package&quot;: {
        &quot;id&quot;: &quot;0&quot;,
        &quot;name&quot;: &quot;glibc&quot;,
        &quot;version&quot;: &quot;&quot;,
        &quot;kind&quot;: &quot;&quot;,
        &quot;source&quot;: null,
        &quot;package_db&quot;: &quot;&quot;,
        &quot;repository_hint&quot;: &quot;&quot;
      },
      &quot;dist&quot;: {
        &quot;id&quot;: &quot;0&quot;,
        &quot;did&quot;: &quot;ubuntu&quot;,
        &quot;name&quot;: &quot;Ubuntu&quot;,
        &quot;version&quot;: &quot;18.04.3 LTS (Bionic Beaver)&quot;,
        &quot;version_code_name&quot;: &quot;bionic&quot;,
        &quot;version_id&quot;: &quot;18.04&quot;,
        &quot;arch&quot;: &quot;&quot;,
        &quot;cpe&quot;: &quot;&quot;,
        &quot;pretty_name&quot;: &quot;&quot;
      },
      &quot;repo&quot;: {
        &quot;id&quot;: &quot;0&quot;,
        &quot;name&quot;: &quot;Ubuntu 18.04.3 LTS&quot;,
        &quot;key&quot;: &quot;&quot;,
        &quot;uri&quot;: &quot;&quot;
      },
      &quot;issued&quot;: &quot;2019-10-12T07:20:50.52Z&quot;,
      &quot;fixed_in_version&quot;: &quot;2.28-0ubuntu1&quot;
    }
  },
  &quot;package_vulnerabilities&quot;: {
    &quot;10&quot;: [
      &quot;356835&quot;
    ]
  }
}
</code></pre>
<h3 id="retrieve-a-vulnerabilityreport-for-a-given-manifest's-content
addressable-hash.
-responses">Responses</h3>
<table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>201</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.2">Created</a></td><td>VulnerabilityReport Created</td><td><a href="reference/api.html#schemavulnerabilityreport">VulnerabilityReport</a></td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>404</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.4">Not Found</a></td><td>Not Found</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>405</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.5">Method Not Allowed</a></td><td>Method Not Allowed</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
<tr><td>500</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.6.1">Internal Server Error</a></td><td>Internal Server Error</td><td><a href="reference/api.html#schemaerror">Error</a></td></tr>
</tbody></table>
<aside class="success">
This operation does not require authentication
</aside>
<h1><a class="header" href="#schemas" id="schemas">Schemas</a></h1>
<h2 id="tocS_Page">Page</h2>
<!-- backwards compatibility -->
<a id="schemapage"></a>
<a id="schema_Page"></a>
<a id="tocSpage"></a>
<a id="tocspage"></a>
<pre><code class="language-json">{
  &quot;size&quot;: 1,
  &quot;next&quot;: &quot;1b4d0db2-e757-4150-bbbb-543658144205&quot;
}

</code></pre>
<p>Page</p>
<h3><a class="header" href="#properties" id="properties">Properties</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>size</td><td>int</td><td>false</td><td>none</td><td>The maximum number of elements in a page</td></tr>
<tr><td>next</td><td>string</td><td>false</td><td>none</td><td>The next id to submit to the api to continue paging</td></tr>
</tbody></table>
<h2 id="tocS_PagedNotifications">PagedNotifications</h2>
<!-- backwards compatibility -->
<a id="schemapagednotifications"></a>
<a id="schema_PagedNotifications"></a>
<a id="tocSpagednotifications"></a>
<a id="tocspagednotifications"></a>
<pre><code class="language-json">{
  &quot;page&quot;: {
    &quot;size&quot;: 100,
    &quot;next&quot;: &quot;1b4d0db2-e757-4150-bbbb-543658144205&quot;
  },
  &quot;notifications&quot;: [
    {
      &quot;id&quot;: &quot;5e4b387e-88d3-4364-86fd-063447a6fad2&quot;,
      &quot;manifest&quot;: &quot;sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a&quot;,
      &quot;reason&quot;: &quot;added&quot;,
      &quot;vulnerability&quot;: {
        &quot;name&quot;: &quot;CVE-2009-5155&quot;,
        &quot;fixed_in_version&quot;: &quot;v0.0.1&quot;,
        &quot;links&quot;: &quot;http://link-to-advisory&quot;,
        &quot;description&quot;: &quot;In the GNU C Library (aka glibc or libc6) before 2.28,\nparse_reg_exp in posix/regcomp.c misparses alternatives,\nwhich allows attackers to cause a denial of service (assertion\nfailure and application exit) or trigger an incorrect result\nby attempting a regular-expression match.\&quot;\n&quot;,
        &quot;normalized_severity&quot;: &quot;Unknown&quot;,
        &quot;package&quot;: {
          &quot;id&quot;: &quot;10&quot;,
          &quot;name&quot;: &quot;libapt-pkg5.0&quot;,
          &quot;version&quot;: &quot;1.6.11&quot;,
          &quot;kind&quot;: &quot;binary&quot;,
          &quot;normalized_version&quot;: &quot;&quot;,
          &quot;arch&quot;: &quot;x86&quot;,
          &quot;module&quot;: &quot;&quot;,
          &quot;cpe&quot;: &quot;&quot;,
          &quot;source&quot;: {
            &quot;id&quot;: &quot;9&quot;,
            &quot;name&quot;: &quot;apt&quot;,
            &quot;version&quot;: &quot;1.6.11&quot;,
            &quot;kind&quot;: &quot;source&quot;,
            &quot;source&quot;: null
          }
        },
        &quot;distribution&quot;: {
          &quot;id&quot;: &quot;1&quot;,
          &quot;did&quot;: &quot;ubuntu&quot;,
          &quot;name&quot;: &quot;Ubuntu&quot;,
          &quot;version&quot;: &quot;18.04.3 LTS (Bionic Beaver)&quot;,
          &quot;version_code_name&quot;: &quot;bionic&quot;,
          &quot;version_id&quot;: &quot;18.04&quot;,
          &quot;arch&quot;: &quot;&quot;,
          &quot;cpe&quot;: &quot;&quot;,
          &quot;pretty_name&quot;: &quot;Ubuntu 18.04.3 LTS&quot;
        },
        &quot;repository&quot;: {
          &quot;id&quot;: &quot;string&quot;,
          &quot;name&quot;: &quot;string&quot;,
          &quot;key&quot;: &quot;string&quot;,
          &quot;uri&quot;: &quot;string&quot;,
          &quot;cpe&quot;: &quot;string&quot;
        }
      }
    }
  ]
}

</code></pre>
<p>PagedNotifications</p>
<h3><a class="header" href="#properties-1" id="properties-1">Properties</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>page</td><td>object</td><td>false</td><td>none</td><td>A page object informing the client the next page to retrieve.<br>If page.next becomes &quot;-1&quot; the client should stop paging.</td></tr>
<tr><td>notifications</td><td>[<a href="reference/api.html#schemanotification">Notification</a>]</td><td>false</td><td>none</td><td>A list of notifications within this page</td></tr>
</tbody></table>
<h2 id="tocS_Callback">Callback</h2>
<!-- backwards compatibility -->
<a id="schemacallback"></a>
<a id="schema_Callback"></a>
<a id="tocScallback"></a>
<a id="tocscallback"></a>
<pre><code class="language-json">{
  &quot;notification_id&quot;: &quot;269886f3-0146-4f08-9bf7-cb1138d48643&quot;,
  &quot;callback&quot;: &quot;http://clair-notifier/api/v1/notifications/269886f3-0146-4f08-9bf7-cb1138d48643&quot;
}

</code></pre>
<p>Callback</p>
<h3><a class="header" href="#properties-2" id="properties-2">Properties</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>notification_id</td><td>string</td><td>false</td><td>none</td><td>the unique identifier for this set of notifications</td></tr>
<tr><td>callback</td><td>string</td><td>false</td><td>none</td><td>the url where notifications can be retrieved</td></tr>
</tbody></table>
<h2 id="tocS_VulnSummary">VulnSummary</h2>
<!-- backwards compatibility -->
<a id="schemavulnsummary"></a>
<a id="schema_VulnSummary"></a>
<a id="tocSvulnsummary"></a>
<a id="tocsvulnsummary"></a>
<pre><code class="language-json">{
  &quot;name&quot;: &quot;CVE-2009-5155&quot;,
  &quot;fixed_in_version&quot;: &quot;v0.0.1&quot;,
  &quot;links&quot;: &quot;http://link-to-advisory&quot;,
  &quot;description&quot;: &quot;In the GNU C Library (aka glibc or libc6) before 2.28,\nparse_reg_exp in posix/regcomp.c misparses alternatives,\nwhich allows attackers to cause a denial of service (assertion\nfailure and application exit) or trigger an incorrect result\nby attempting a regular-expression match.\&quot;\n&quot;,
  &quot;normalized_severity&quot;: &quot;Unknown&quot;,
  &quot;package&quot;: {
    &quot;id&quot;: &quot;10&quot;,
    &quot;name&quot;: &quot;libapt-pkg5.0&quot;,
    &quot;version&quot;: &quot;1.6.11&quot;,
    &quot;kind&quot;: &quot;binary&quot;,
    &quot;normalized_version&quot;: &quot;&quot;,
    &quot;arch&quot;: &quot;x86&quot;,
    &quot;module&quot;: &quot;&quot;,
    &quot;cpe&quot;: &quot;&quot;,
    &quot;source&quot;: {
      &quot;id&quot;: &quot;9&quot;,
      &quot;name&quot;: &quot;apt&quot;,
      &quot;version&quot;: &quot;1.6.11&quot;,
      &quot;kind&quot;: &quot;source&quot;,
      &quot;source&quot;: null
    }
  },
  &quot;distribution&quot;: {
    &quot;id&quot;: &quot;1&quot;,
    &quot;did&quot;: &quot;ubuntu&quot;,
    &quot;name&quot;: &quot;Ubuntu&quot;,
    &quot;version&quot;: &quot;18.04.3 LTS (Bionic Beaver)&quot;,
    &quot;version_code_name&quot;: &quot;bionic&quot;,
    &quot;version_id&quot;: &quot;18.04&quot;,
    &quot;arch&quot;: &quot;&quot;,
    &quot;cpe&quot;: &quot;&quot;,
    &quot;pretty_name&quot;: &quot;Ubuntu 18.04.3 LTS&quot;
  },
  &quot;repository&quot;: {
    &quot;id&quot;: &quot;string&quot;,
    &quot;name&quot;: &quot;string&quot;,
    &quot;key&quot;: &quot;string&quot;,
    &quot;uri&quot;: &quot;string&quot;,
    &quot;cpe&quot;: &quot;string&quot;
  }
}

</code></pre>
<p>VulnSummary</p>
<h3><a class="header" href="#properties-3" id="properties-3">Properties</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>name</td><td>string</td><td>false</td><td>none</td><td>the vulnerability name</td></tr>
<tr><td>fixed_in_version</td><td>string</td><td>false</td><td>none</td><td>the version at which the vulnerability is fixed in. empty if not fixed.</td></tr>
<tr><td>links</td><td>string</td><td>false</td><td>none</td><td>links to external information about vulnerability</td></tr>
<tr><td>description</td><td>string</td><td>false</td><td>none</td><td>the vulnerability name</td></tr>
<tr><td>normalized_severity</td><td>string</td><td>false</td><td>none</td><td>A well defined set of severity strings guaranteed to be present.</td></tr>
<tr><td>package</td><td><a href="reference/api.html#schemapackage">Package</a></td><td>false</td><td>none</td><td>A package discovered by indexing a Manifest</td></tr>
<tr><td>distribution</td><td><a href="reference/api.html#schemadistribution">Distribution</a></td><td>false</td><td>none</td><td>An indexed distribution discovered in a layer. See<br>https://www.freedesktop.org/software/systemd/man/os-release.html<br>for explanations and example of fields.</td></tr>
<tr><td>repository</td><td><a href="reference/api.html#schemarepository">Repository</a></td><td>false</td><td>none</td><td>A package repository</td></tr>
</tbody></table>
<h4><a class="header" href="#enumerated-values" id="enumerated-values">Enumerated Values</a></h4>
<table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody>
<tr><td>normalized_severity</td><td>Unknown</td></tr>
<tr><td>normalized_severity</td><td>Negligible</td></tr>
<tr><td>normalized_severity</td><td>Low</td></tr>
<tr><td>normalized_severity</td><td>Medium</td></tr>
<tr><td>normalized_severity</td><td>High</td></tr>
<tr><td>normalized_severity</td><td>Critical</td></tr>
<tr><td>normalized_severity</td><td>Defcon1</td></tr>
</tbody></table>
<h2 id="tocS_Notification">Notification</h2>
<!-- backwards compatibility -->
<a id="schemanotification"></a>
<a id="schema_Notification"></a>
<a id="tocSnotification"></a>
<a id="tocsnotification"></a>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;5e4b387e-88d3-4364-86fd-063447a6fad2&quot;,
  &quot;manifest&quot;: &quot;sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a&quot;,
  &quot;reason&quot;: &quot;added&quot;,
  &quot;vulnerability&quot;: {
    &quot;name&quot;: &quot;CVE-2009-5155&quot;,
    &quot;fixed_in_version&quot;: &quot;v0.0.1&quot;,
    &quot;links&quot;: &quot;http://link-to-advisory&quot;,
    &quot;description&quot;: &quot;In the GNU C Library (aka glibc or libc6) before 2.28,\nparse_reg_exp in posix/regcomp.c misparses alternatives,\nwhich allows attackers to cause a denial of service (assertion\nfailure and application exit) or trigger an incorrect result\nby attempting a regular-expression match.\&quot;\n&quot;,
    &quot;normalized_severity&quot;: &quot;Unknown&quot;,
    &quot;package&quot;: {
      &quot;id&quot;: &quot;10&quot;,
      &quot;name&quot;: &quot;libapt-pkg5.0&quot;,
      &quot;version&quot;: &quot;1.6.11&quot;,
      &quot;kind&quot;: &quot;binary&quot;,
      &quot;normalized_version&quot;: &quot;&quot;,
      &quot;arch&quot;: &quot;x86&quot;,
      &quot;module&quot;: &quot;&quot;,
      &quot;cpe&quot;: &quot;&quot;,
      &quot;source&quot;: {
        &quot;id&quot;: &quot;9&quot;,
        &quot;name&quot;: &quot;apt&quot;,
        &quot;version&quot;: &quot;1.6.11&quot;,
        &quot;kind&quot;: &quot;source&quot;,
        &quot;source&quot;: null
      }
    },
    &quot;distribution&quot;: {
      &quot;id&quot;: &quot;1&quot;,
      &quot;did&quot;: &quot;ubuntu&quot;,
      &quot;name&quot;: &quot;Ubuntu&quot;,
      &quot;version&quot;: &quot;18.04.3 LTS (Bionic Beaver)&quot;,
      &quot;version_code_name&quot;: &quot;bionic&quot;,
      &quot;version_id&quot;: &quot;18.04&quot;,
      &quot;arch&quot;: &quot;&quot;,
      &quot;cpe&quot;: &quot;&quot;,
      &quot;pretty_name&quot;: &quot;Ubuntu 18.04.3 LTS&quot;
    },
    &quot;repository&quot;: {
      &quot;id&quot;: &quot;string&quot;,
      &quot;name&quot;: &quot;string&quot;,
      &quot;key&quot;: &quot;string&quot;,
      &quot;uri&quot;: &quot;string&quot;,
      &quot;cpe&quot;: &quot;string&quot;
    }
  }
}

</code></pre>
<p>Notification</p>
<h3><a class="header" href="#properties-4" id="properties-4">Properties</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>id</td><td>string</td><td>false</td><td>none</td><td>a unique identifier for this notification</td></tr>
<tr><td>manifest</td><td>string</td><td>false</td><td>none</td><td>the hash of the manifest affected by the provided vulnerability</td></tr>
<tr><td>reason</td><td>string</td><td>false</td><td>none</td><td>the reason for the notifcation, [added</td></tr>
<tr><td>vulnerability</td><td><a href="reference/api.html#schemavulnsummary">VulnSummary</a></td><td>false</td><td>none</td><td>A summary of a vulnerability</td></tr>
</tbody></table>
<h2 id="tocS_Environment">Environment</h2>
<!-- backwards compatibility -->
<a id="schemaenvironment"></a>
<a id="schema_Environment"></a>
<a id="tocSenvironment"></a>
<a id="tocsenvironment"></a>
<pre><code class="language-json">{
  &quot;package_db&quot;: &quot;var/lib/dpkg/status&quot;,
  &quot;introduced_in&quot;: &quot;sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3&quot;,
  &quot;distribution_id&quot;: &quot;1&quot;
}

</code></pre>
<p>Environment</p>
<h3><a class="header" href="#properties-5" id="properties-5">Properties</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>package_db</td><td>string</td><td>true</td><td>none</td><td>The filesystem path or unique identifier of a package database.</td></tr>
<tr><td>introduced_in</td><td><a href="reference/api.html#schemadigest">Digest</a></td><td>true</td><td>none</td><td>A digest string with prefixed algorithm. The format is described here:<br>https://github.com/opencontainers/image-spec/blob/master/descriptor.md#digests<br><br>Digests are used throughout the API to identify Layers and Manifests.</td></tr>
<tr><td>distribution_id</td><td>string</td><td>true</td><td>none</td><td>The distribution ID found in an associated IndexReport or<br>VulnerabilityReport.</td></tr>
</tbody></table>
<h2 id="tocS_IndexReport">IndexReport</h2>
<!-- backwards compatibility -->
<a id="schemaindexreport"></a>
<a id="schema_IndexReport"></a>
<a id="tocSindexreport"></a>
<a id="tocsindexreport"></a>
<pre><code class="language-json">{
  &quot;manifest_hash&quot;: &quot;sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3&quot;,
  &quot;state&quot;: &quot;IndexFinished&quot;,
  &quot;packages&quot;: {
    &quot;10&quot;: {
      &quot;id&quot;: &quot;10&quot;,
      &quot;name&quot;: &quot;libapt-pkg5.0&quot;,
      &quot;version&quot;: &quot;1.6.11&quot;,
      &quot;kind&quot;: &quot;binary&quot;,
      &quot;normalized_version&quot;: &quot;&quot;,
      &quot;arch&quot;: &quot;x86&quot;,
      &quot;module&quot;: &quot;&quot;,
      &quot;cpe&quot;: &quot;&quot;,
      &quot;source&quot;: {
        &quot;id&quot;: &quot;9&quot;,
        &quot;name&quot;: &quot;apt&quot;,
        &quot;version&quot;: &quot;1.6.11&quot;,
        &quot;kind&quot;: &quot;source&quot;,
        &quot;source&quot;: null
      }
    }
  },
  &quot;distributions&quot;: {
    &quot;1&quot;: {
      &quot;id&quot;: &quot;1&quot;,
      &quot;did&quot;: &quot;ubuntu&quot;,
      &quot;name&quot;: &quot;Ubuntu&quot;,
      &quot;version&quot;: &quot;18.04.3 LTS (Bionic Beaver)&quot;,
      &quot;version_code_name&quot;: &quot;bionic&quot;,
      &quot;version_id&quot;: &quot;18.04&quot;,
      &quot;arch&quot;: &quot;&quot;,
      &quot;cpe&quot;: &quot;&quot;,
      &quot;pretty_name&quot;: &quot;Ubuntu 18.04.3 LTS&quot;
    }
  },
  &quot;environments&quot;: {
    &quot;10&quot;: [
      {
        &quot;package_db&quot;: &quot;var/lib/dpkg/status&quot;,
        &quot;introduced_in&quot;: &quot;sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a&quot;,
        &quot;distribution_id&quot;: &quot;1&quot;
      }
    ]
  },
  &quot;success&quot;: true,
  &quot;err&quot;: &quot;&quot;
}

</code></pre>
<p>IndexReport</p>
<h3><a class="header" href="#properties-6" id="properties-6">Properties</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>manifest_hash</td><td><a href="reference/api.html#schemadigest">Digest</a></td><td>true</td><td>none</td><td>A digest string with prefixed algorithm. The format is described here:<br>https://github.com/opencontainers/image-spec/blob/master/descriptor.md#digests<br><br>Digests are used throughout the API to identify Layers and Manifests.</td></tr>
<tr><td>state</td><td>string</td><td>true</td><td>none</td><td>The current state of the index operation</td></tr>
<tr><td>packages</td><td>object</td><td>true</td><td>none</td><td>A map of Package objects indexed by Package.id</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="reference/api.html#schemapackage">Package</a></td><td>false</td><td>none</td><td>A package discovered by indexing a Manifest</td></tr>
<tr><td>distributions</td><td>object</td><td>true</td><td>none</td><td>A map of Distribution objects keyed by their Distribution.id<br>discovered in the manifest.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="reference/api.html#schemadistribution">Distribution</a></td><td>false</td><td>none</td><td>An indexed distribution discovered in a layer. See<br>https://www.freedesktop.org/software/systemd/man/os-release.html<br>for explanations and example of fields.</td></tr>
<tr><td>environments</td><td>object</td><td>true</td><td>none</td><td>A map of lists containing Environment objects keyed by the<br>associated Package.id.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td>[<a href="reference/api.html#schemaenvironment">Environment</a>]</td><td>false</td><td>none</td><td>[The environment a particular package was discovered in.]</td></tr>
<tr><td>success</td><td>boolean</td><td>true</td><td>none</td><td>A bool indicating succcessful index</td></tr>
<tr><td>err</td><td>string</td><td>true</td><td>none</td><td>An error message on event of unsuccessful index</td></tr>
</tbody></table>
<h2 id="tocS_VulnerabilityReport">VulnerabilityReport</h2>
<!-- backwards compatibility -->
<a id="schemavulnerabilityreport"></a>
<a id="schema_VulnerabilityReport"></a>
<a id="tocSvulnerabilityreport"></a>
<a id="tocsvulnerabilityreport"></a>
<pre><code class="language-json">{
  &quot;manifest_hash&quot;: &quot;sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3&quot;,
  &quot;packages&quot;: {
    &quot;10&quot;: {
      &quot;id&quot;: &quot;10&quot;,
      &quot;name&quot;: &quot;libapt-pkg5.0&quot;,
      &quot;version&quot;: &quot;1.6.11&quot;,
      &quot;kind&quot;: &quot;binary&quot;,
      &quot;normalized_version&quot;: &quot;&quot;,
      &quot;arch&quot;: &quot;x86&quot;,
      &quot;module&quot;: &quot;&quot;,
      &quot;cpe&quot;: &quot;&quot;,
      &quot;source&quot;: {
        &quot;id&quot;: &quot;9&quot;,
        &quot;name&quot;: &quot;apt&quot;,
        &quot;version&quot;: &quot;1.6.11&quot;,
        &quot;kind&quot;: &quot;source&quot;,
        &quot;source&quot;: null
      }
    }
  },
  &quot;distributions&quot;: {
    &quot;1&quot;: {
      &quot;id&quot;: &quot;1&quot;,
      &quot;did&quot;: &quot;ubuntu&quot;,
      &quot;name&quot;: &quot;Ubuntu&quot;,
      &quot;version&quot;: &quot;18.04.3 LTS (Bionic Beaver)&quot;,
      &quot;version_code_name&quot;: &quot;bionic&quot;,
      &quot;version_id&quot;: &quot;18.04&quot;,
      &quot;arch&quot;: &quot;&quot;,
      &quot;cpe&quot;: &quot;&quot;,
      &quot;pretty_name&quot;: &quot;Ubuntu 18.04.3 LTS&quot;
    }
  },
  &quot;environments&quot;: {
    &quot;10&quot;: [
      {
        &quot;package_db&quot;: &quot;var/lib/dpkg/status&quot;,
        &quot;introduced_in&quot;: &quot;sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a&quot;,
        &quot;distribution_id&quot;: &quot;1&quot;
      }
    ]
  },
  &quot;vulnerabilities&quot;: {
    &quot;356835&quot;: {
      &quot;id&quot;: &quot;356835&quot;,
      &quot;updater&quot;: &quot;&quot;,
      &quot;name&quot;: &quot;CVE-2009-5155&quot;,
      &quot;description&quot;: &quot;In the GNU C Library (aka glibc or libc6) before 2.28,\nparse_reg_exp in posix/regcomp.c misparses alternatives,\nwhich allows attackers to cause a denial of service (assertion\nfailure and application exit) or trigger an incorrect result\nby attempting a regular-expression match.\&quot;\n&quot;,
      &quot;links&quot;: &quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-5155\nhttp://people.canonical.com/~ubuntu-security/cve/2009/CVE-2009-5155.html\nhttps://sourceware.org/bugzilla/show_bug.cgi?id=11053\nhttps://debbugs.gnu.org/cgi/bugreport.cgi?bug=22793\nhttps://debbugs.gnu.org/cgi/bugreport.cgi?bug=32806\nhttps://debbugs.gnu.org/cgi/bugreport.cgi?bug=34238\nhttps://sourceware.org/bugzilla/show_bug.cgi?id=18986\&quot;\n&quot;,
      &quot;severity&quot;: &quot;Low&quot;,
      &quot;normalized_severity&quot;: &quot;Low&quot;,
      &quot;package&quot;: {
        &quot;id&quot;: &quot;0&quot;,
        &quot;name&quot;: &quot;glibc&quot;,
        &quot;version&quot;: &quot;&quot;,
        &quot;kind&quot;: &quot;&quot;,
        &quot;source&quot;: null,
        &quot;package_db&quot;: &quot;&quot;,
        &quot;repository_hint&quot;: &quot;&quot;
      },
      &quot;dist&quot;: {
        &quot;id&quot;: &quot;0&quot;,
        &quot;did&quot;: &quot;ubuntu&quot;,
        &quot;name&quot;: &quot;Ubuntu&quot;,
        &quot;version&quot;: &quot;18.04.3 LTS (Bionic Beaver)&quot;,
        &quot;version_code_name&quot;: &quot;bionic&quot;,
        &quot;version_id&quot;: &quot;18.04&quot;,
        &quot;arch&quot;: &quot;&quot;,
        &quot;cpe&quot;: &quot;&quot;,
        &quot;pretty_name&quot;: &quot;&quot;
      },
      &quot;repo&quot;: {
        &quot;id&quot;: &quot;0&quot;,
        &quot;name&quot;: &quot;Ubuntu 18.04.3 LTS&quot;,
        &quot;key&quot;: &quot;&quot;,
        &quot;uri&quot;: &quot;&quot;
      },
      &quot;issued&quot;: &quot;2019-10-12T07:20:50.52Z&quot;,
      &quot;fixed_in_version&quot;: &quot;2.28-0ubuntu1&quot;
    }
  },
  &quot;package_vulnerabilities&quot;: {
    &quot;10&quot;: [
      &quot;356835&quot;
    ]
  }
}

</code></pre>
<p>VulnerabilityReport</p>
<h3><a class="header" href="#properties-7" id="properties-7">Properties</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>manifest_hash</td><td><a href="reference/api.html#schemadigest">Digest</a></td><td>true</td><td>none</td><td>A digest string with prefixed algorithm. The format is described here:<br>https://github.com/opencontainers/image-spec/blob/master/descriptor.md#digests<br><br>Digests are used throughout the API to identify Layers and Manifests.</td></tr>
<tr><td>packages</td><td>object</td><td>true</td><td>none</td><td>A map of Package objects indexed by Package.id</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="reference/api.html#schemapackage">Package</a></td><td>false</td><td>none</td><td>A package discovered by indexing a Manifest</td></tr>
<tr><td>distributions</td><td>object</td><td>true</td><td>none</td><td>A map of Distribution objects indexed by Distribution.id.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="reference/api.html#schemadistribution">Distribution</a></td><td>false</td><td>none</td><td>An indexed distribution discovered in a layer. See<br>https://www.freedesktop.org/software/systemd/man/os-release.html<br>for explanations and example of fields.</td></tr>
<tr><td>environments</td><td>object</td><td>true</td><td>none</td><td>A mapping of Environment lists indexed by Package.id</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td>[<a href="reference/api.html#schemaenvironment">Environment</a>]</td><td>false</td><td>none</td><td>[The environment a particular package was discovered in.]</td></tr>
<tr><td>vulnerabilities</td><td>object</td><td>true</td><td>none</td><td>A map of Vulnerabilities indexed by Vulnerability.id</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="reference/api.html#schemavulnerability">Vulnerability</a></td><td>false</td><td>none</td><td>A unique vulnerability indexed by Clair</td></tr>
<tr><td>package_vulnerabilities</td><td>object</td><td>true</td><td>none</td><td>A mapping of Vulnerability.id lists indexed by Package.id.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td>[string]</td><td>false</td><td>none</td><td>none</td></tr>
</tbody></table>
<h2 id="tocS_Vulnerability">Vulnerability</h2>
<!-- backwards compatibility -->
<a id="schemavulnerability"></a>
<a id="schema_Vulnerability"></a>
<a id="tocSvulnerability"></a>
<a id="tocsvulnerability"></a>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;356835&quot;,
  &quot;updater&quot;: &quot;&quot;,
  &quot;name&quot;: &quot;CVE-2009-5155&quot;,
  &quot;description&quot;: &quot;In the GNU C Library (aka glibc or libc6) before 2.28,\nparse_reg_exp in posix/regcomp.c misparses alternatives,\nwhich allows attackers to cause a denial of service (assertion\nfailure and application exit) or trigger an incorrect result\nby attempting a regular-expression match.\&quot;\n&quot;,
  &quot;links&quot;: &quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-5155\nhttp://people.canonical.com/~ubuntu-security/cve/2009/CVE-2009-5155.html\nhttps://sourceware.org/bugzilla/show_bug.cgi?id=11053\nhttps://debbugs.gnu.org/cgi/bugreport.cgi?bug=22793\nhttps://debbugs.gnu.org/cgi/bugreport.cgi?bug=32806\nhttps://debbugs.gnu.org/cgi/bugreport.cgi?bug=34238\nhttps://sourceware.org/bugzilla/show_bug.cgi?id=18986\&quot;\n&quot;,
  &quot;severity&quot;: &quot;Low&quot;,
  &quot;normalized_severity&quot;: &quot;Low&quot;,
  &quot;package&quot;: {
    &quot;id&quot;: &quot;0&quot;,
    &quot;name&quot;: &quot;glibc&quot;,
    &quot;version&quot;: &quot;&quot;,
    &quot;kind&quot;: &quot;&quot;,
    &quot;source&quot;: null,
    &quot;package_db&quot;: &quot;&quot;,
    &quot;repository_hint&quot;: &quot;&quot;
  },
  &quot;dist&quot;: {
    &quot;id&quot;: &quot;0&quot;,
    &quot;did&quot;: &quot;ubuntu&quot;,
    &quot;name&quot;: &quot;Ubuntu&quot;,
    &quot;version&quot;: &quot;18.04.3 LTS (Bionic Beaver)&quot;,
    &quot;version_code_name&quot;: &quot;bionic&quot;,
    &quot;version_id&quot;: &quot;18.04&quot;,
    &quot;arch&quot;: &quot;&quot;,
    &quot;cpe&quot;: &quot;&quot;,
    &quot;pretty_name&quot;: &quot;&quot;
  },
  &quot;repo&quot;: {
    &quot;id&quot;: &quot;0&quot;,
    &quot;name&quot;: &quot;Ubuntu 18.04.3 LTS&quot;,
    &quot;key&quot;: &quot;&quot;,
    &quot;uri&quot;: &quot;&quot;
  },
  &quot;issued&quot;: &quot;2019-10-12T07:20:50.52Z&quot;,
  &quot;fixed_in_version&quot;: &quot;2.28-0ubuntu1&quot;,
  &quot;x-widdershins-oldRef&quot;: &quot;#/components/examples/Vulnerability/value&quot;
}

</code></pre>
<p>Vulnerability</p>
<h3><a class="header" href="#properties-8" id="properties-8">Properties</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>id</td><td>string</td><td>true</td><td>none</td><td>A unique ID representing this vulnerability.</td></tr>
<tr><td>updater</td><td>string</td><td>true</td><td>none</td><td>A unique ID representing this vulnerability.</td></tr>
<tr><td>name</td><td>string</td><td>true</td><td>none</td><td>Name of this specific vulnerability.</td></tr>
<tr><td>description</td><td>string</td><td>true</td><td>none</td><td>A description of this specific vulnerability.</td></tr>
<tr><td>links</td><td>string</td><td>true</td><td>none</td><td>A space separate list of links to any external information.</td></tr>
<tr><td>severity</td><td>string</td><td>true</td><td>none</td><td>A severity keyword taken verbatim from the vulnerability source.</td></tr>
<tr><td>normalized_severity</td><td>string</td><td>true</td><td>none</td><td>A well defined set of severity strings guaranteed to be present.</td></tr>
<tr><td>package</td><td><a href="reference/api.html#schemapackage">Package</a></td><td>false</td><td>none</td><td>A package discovered by indexing a Manifest</td></tr>
<tr><td>distribution</td><td><a href="reference/api.html#schemadistribution">Distribution</a></td><td>false</td><td>none</td><td>An indexed distribution discovered in a layer. See<br>https://www.freedesktop.org/software/systemd/man/os-release.html<br>for explanations and example of fields.</td></tr>
<tr><td>repository</td><td><a href="reference/api.html#schemarepository">Repository</a></td><td>false</td><td>none</td><td>A package repository</td></tr>
<tr><td>issued</td><td>string</td><td>false</td><td>none</td><td>The timestamp in which the vulnerability was issued</td></tr>
<tr><td>range</td><td>string</td><td>false</td><td>none</td><td>The range of package versions that are affected by this vulnerability</td></tr>
<tr><td>fixed_in_version</td><td>string</td><td>true</td><td>none</td><td>A unique ID representing this vulnerability.</td></tr>
</tbody></table>
<h4><a class="header" href="#enumerated-values-1" id="enumerated-values-1">Enumerated Values</a></h4>
<table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody>
<tr><td>normalized_severity</td><td>Unknown</td></tr>
<tr><td>normalized_severity</td><td>Negligible</td></tr>
<tr><td>normalized_severity</td><td>Low</td></tr>
<tr><td>normalized_severity</td><td>Medium</td></tr>
<tr><td>normalized_severity</td><td>High</td></tr>
<tr><td>normalized_severity</td><td>Critical</td></tr>
<tr><td>normalized_severity</td><td>Defcon1</td></tr>
</tbody></table>
<h2 id="tocS_Distribution">Distribution</h2>
<!-- backwards compatibility -->
<a id="schemadistribution"></a>
<a id="schema_Distribution"></a>
<a id="tocSdistribution"></a>
<a id="tocsdistribution"></a>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;1&quot;,
  &quot;did&quot;: &quot;ubuntu&quot;,
  &quot;name&quot;: &quot;Ubuntu&quot;,
  &quot;version&quot;: &quot;18.04.3 LTS (Bionic Beaver)&quot;,
  &quot;version_code_name&quot;: &quot;bionic&quot;,
  &quot;version_id&quot;: &quot;18.04&quot;,
  &quot;arch&quot;: &quot;&quot;,
  &quot;cpe&quot;: &quot;&quot;,
  &quot;pretty_name&quot;: &quot;Ubuntu 18.04.3 LTS&quot;,
  &quot;x-widdershins-oldRef&quot;: &quot;#/components/examples/Distribution/value&quot;
}

</code></pre>
<p>Distribution</p>
<h3><a class="header" href="#properties-9" id="properties-9">Properties</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>id</td><td>string</td><td>true</td><td>none</td><td>A unique ID representing this distribution</td></tr>
<tr><td>did</td><td>string</td><td>true</td><td>none</td><td>none</td></tr>
<tr><td>name</td><td>string</td><td>true</td><td>none</td><td>none</td></tr>
<tr><td>version</td><td>string</td><td>true</td><td>none</td><td>none</td></tr>
<tr><td>version_code_name</td><td>string</td><td>true</td><td>none</td><td>none</td></tr>
<tr><td>version_id</td><td>string</td><td>true</td><td>none</td><td>none</td></tr>
<tr><td>arch</td><td>string</td><td>true</td><td>none</td><td>none</td></tr>
<tr><td>cpe</td><td>string</td><td>true</td><td>none</td><td>none</td></tr>
<tr><td>pretty_name</td><td>string</td><td>true</td><td>none</td><td>none</td></tr>
</tbody></table>
<h2 id="tocS_SourcePackage">SourcePackage</h2>
<!-- backwards compatibility -->
<a id="schemasourcepackage"></a>
<a id="schema_SourcePackage"></a>
<a id="tocSsourcepackage"></a>
<a id="tocssourcepackage"></a>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;10&quot;,
  &quot;name&quot;: &quot;libapt-pkg5.0&quot;,
  &quot;version&quot;: &quot;1.6.11&quot;,
  &quot;kind&quot;: &quot;binary&quot;,
  &quot;normalized_version&quot;: &quot;&quot;,
  &quot;arch&quot;: &quot;x86&quot;,
  &quot;module&quot;: &quot;&quot;,
  &quot;cpe&quot;: &quot;&quot;,
  &quot;source&quot;: {
    &quot;id&quot;: &quot;9&quot;,
    &quot;name&quot;: &quot;apt&quot;,
    &quot;version&quot;: &quot;1.6.11&quot;,
    &quot;kind&quot;: &quot;source&quot;,
    &quot;source&quot;: null
  },
  &quot;x-widdershins-oldRef&quot;: &quot;#/components/examples/Package/value&quot;
}

</code></pre>
<p>SourcePackage</p>
<h3><a class="header" href="#properties-10" id="properties-10">Properties</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>id</td><td>string</td><td>true</td><td>none</td><td>A unique ID representing this package</td></tr>
<tr><td>name</td><td>string</td><td>true</td><td>none</td><td>Name of the Package</td></tr>
<tr><td>version</td><td>string</td><td>true</td><td>none</td><td>Version of the Package</td></tr>
<tr><td>kind</td><td>string</td><td>false</td><td>none</td><td>Kind of package. Source</td></tr>
<tr><td>source</td><td>string</td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>normalized_version</td><td><a href="reference/api.html#schemaversion">Version</a></td><td>false</td><td>none</td><td>Version is a normalized claircore version, composed of a &quot;kind&quot; and an<br>array of integers such that two versions of the same kind have the<br>correct ordering when the integers are compared pair-wise.</td></tr>
<tr><td>arch</td><td>string</td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>module</td><td>string</td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>cpe</td><td>string</td><td>false</td><td>none</td><td>A CPE identifying the package</td></tr>
</tbody></table>
<h2 id="tocS_Package">Package</h2>
<!-- backwards compatibility -->
<a id="schemapackage"></a>
<a id="schema_Package"></a>
<a id="tocSpackage"></a>
<a id="tocspackage"></a>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;10&quot;,
  &quot;name&quot;: &quot;libapt-pkg5.0&quot;,
  &quot;version&quot;: &quot;1.6.11&quot;,
  &quot;kind&quot;: &quot;binary&quot;,
  &quot;normalized_version&quot;: &quot;&quot;,
  &quot;arch&quot;: &quot;x86&quot;,
  &quot;module&quot;: &quot;&quot;,
  &quot;cpe&quot;: &quot;&quot;,
  &quot;source&quot;: {
    &quot;id&quot;: &quot;9&quot;,
    &quot;name&quot;: &quot;apt&quot;,
    &quot;version&quot;: &quot;1.6.11&quot;,
    &quot;kind&quot;: &quot;source&quot;,
    &quot;source&quot;: null
  },
  &quot;x-widdershins-oldRef&quot;: &quot;#/components/examples/Package/value&quot;
}

</code></pre>
<p>Package</p>
<h3><a class="header" href="#properties-11" id="properties-11">Properties</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>id</td><td>string</td><td>true</td><td>none</td><td>A unique ID representing this package</td></tr>
<tr><td>name</td><td>string</td><td>true</td><td>none</td><td>Name of the Package</td></tr>
<tr><td>version</td><td>string</td><td>true</td><td>none</td><td>Version of the Package</td></tr>
<tr><td>kind</td><td>string</td><td>false</td><td>none</td><td>Kind of package. Source</td></tr>
<tr><td>source</td><td><a href="reference/api.html#schemasourcepackage">SourcePackage</a></td><td>false</td><td>none</td><td>A source package affiliated with a Package</td></tr>
<tr><td>normalized_version</td><td><a href="reference/api.html#schemaversion">Version</a></td><td>false</td><td>none</td><td>Version is a normalized claircore version, composed of a &quot;kind&quot; and an<br>array of integers such that two versions of the same kind have the<br>correct ordering when the integers are compared pair-wise.</td></tr>
<tr><td>arch</td><td>string</td><td>false</td><td>none</td><td>The package's target system architecture</td></tr>
<tr><td>module</td><td>string</td><td>false</td><td>none</td><td>A module further defining a namespace for a package</td></tr>
<tr><td>cpe</td><td>string</td><td>false</td><td>none</td><td>A CPE identifying the package</td></tr>
</tbody></table>
<h2 id="tocS_Repository">Repository</h2>
<!-- backwards compatibility -->
<a id="schemarepository"></a>
<a id="schema_Repository"></a>
<a id="tocSrepository"></a>
<a id="tocsrepository"></a>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;string&quot;,
  &quot;name&quot;: &quot;string&quot;,
  &quot;key&quot;: &quot;string&quot;,
  &quot;uri&quot;: &quot;string&quot;,
  &quot;cpe&quot;: &quot;string&quot;
}

</code></pre>
<p>Repository</p>
<h3><a class="header" href="#properties-12" id="properties-12">Properties</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>id</td><td>string</td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>name</td><td>string</td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>key</td><td>string</td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>uri</td><td>string</td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>cpe</td><td>string</td><td>false</td><td>none</td><td>none</td></tr>
</tbody></table>
<h2 id="tocS_Version">Version</h2>
<!-- backwards compatibility -->
<a id="schemaversion"></a>
<a id="schema_Version"></a>
<a id="tocSversion"></a>
<a id="tocsversion"></a>
<pre><code class="language-json">&quot;pep440:0.0.0.0.0.0.0.0.0&quot;

</code></pre>
<p>Version</p>
<h3><a class="header" href="#properties-13" id="properties-13">Properties</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>Version</td><td>string</td><td>false</td><td>none</td><td>Version is a normalized claircore version, composed of a &quot;kind&quot; and an<br>array of integers such that two versions of the same kind have the<br>correct ordering when the integers are compared pair-wise.</td></tr>
</tbody></table>
<h2 id="tocS_Manifest">Manifest</h2>
<!-- backwards compatibility -->
<a id="schemamanifest"></a>
<a id="schema_Manifest"></a>
<a id="tocSmanifest"></a>
<a id="tocsmanifest"></a>
<pre><code class="language-json">{
  &quot;hash&quot;: &quot;sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3&quot;,
  &quot;layers&quot;: [
    {
      &quot;hash&quot;: &quot;sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3&quot;,
      &quot;uri&quot;: &quot;https://storage.example.com/blob/2f077db56abccc19f16f140f629ae98e904b4b7d563957a7fc319bd11b82ba36\n&quot;,
      &quot;headers&quot;: {
        &quot;property1&quot;: [
          &quot;string&quot;
        ],
        &quot;property2&quot;: [
          &quot;string&quot;
        ]
      }
    }
  ]
}

</code></pre>
<p>Manifest</p>
<h3><a class="header" href="#properties-14" id="properties-14">Properties</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>hash</td><td><a href="reference/api.html#schemadigest">Digest</a></td><td>true</td><td>none</td><td>A digest string with prefixed algorithm. The format is described here:<br>https://github.com/opencontainers/image-spec/blob/master/descriptor.md#digests<br><br>Digests are used throughout the API to identify Layers and Manifests.</td></tr>
<tr><td>layers</td><td>[<a href="reference/api.html#schemalayer">Layer</a>]</td><td>true</td><td>none</td><td>[A Layer within a Manifest and where Clair may retrieve it.]</td></tr>
</tbody></table>
<h2 id="tocS_Layer">Layer</h2>
<!-- backwards compatibility -->
<a id="schemalayer"></a>
<a id="schema_Layer"></a>
<a id="tocSlayer"></a>
<a id="tocslayer"></a>
<pre><code class="language-json">{
  &quot;hash&quot;: &quot;sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3&quot;,
  &quot;uri&quot;: &quot;https://storage.example.com/blob/2f077db56abccc19f16f140f629ae98e904b4b7d563957a7fc319bd11b82ba36\n&quot;,
  &quot;headers&quot;: {
    &quot;property1&quot;: [
      &quot;string&quot;
    ],
    &quot;property2&quot;: [
      &quot;string&quot;
    ]
  }
}

</code></pre>
<p>Layer</p>
<h3><a class="header" href="#properties-15" id="properties-15">Properties</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>hash</td><td><a href="reference/api.html#schemadigest">Digest</a></td><td>true</td><td>none</td><td>A digest string with prefixed algorithm. The format is described here:<br>https://github.com/opencontainers/image-spec/blob/master/descriptor.md#digests<br><br>Digests are used throughout the API to identify Layers and Manifests.</td></tr>
<tr><td>uri</td><td>string</td><td>true</td><td>none</td><td>A URI describing where the layer may be found. Implementations<br>MUST support http(s) schemes and MAY support additional<br>schemes.</td></tr>
<tr><td>headers</td><td>object</td><td>true</td><td>none</td><td>map of arrays of header values keyed by header<br>value. e.g. map[string][]string</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td>[string]</td><td>false</td><td>none</td><td>none</td></tr>
</tbody></table>
<h2 id="tocS_Error">Error</h2>
<!-- backwards compatibility -->
<a id="schemaerror"></a>
<a id="schema_Error"></a>
<a id="tocSerror"></a>
<a id="tocserror"></a>
<pre><code class="language-json">{
  &quot;code&quot;: &quot;string&quot;,
  &quot;message&quot;: &quot;string&quot;
}

</code></pre>
<p>Error</p>
<h3><a class="header" href="#properties-16" id="properties-16">Properties</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>code</td><td>string</td><td>false</td><td>none</td><td>a code for this particular error</td></tr>
<tr><td>message</td><td>string</td><td>false</td><td>none</td><td>a message with further detail</td></tr>
</tbody></table>
<h2 id="tocS_State">State</h2>
<!-- backwards compatibility -->
<a id="schemastate"></a>
<a id="schema_State"></a>
<a id="tocSstate"></a>
<a id="tocsstate"></a>
<pre><code class="language-json">{
  &quot;state&quot;: &quot;aae368a064d7c5a433d0bf2c4f5554cc&quot;
}

</code></pre>
<p>State</p>
<h3><a class="header" href="#properties-17" id="properties-17">Properties</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>state</td><td>string</td><td>true</td><td>none</td><td>an opaque identifier</td></tr>
</tbody></table>
<h2 id="tocS_Digest">Digest</h2>
<!-- backwards compatibility -->
<a id="schemadigest"></a>
<a id="schema_Digest"></a>
<a id="tocSdigest"></a>
<a id="tocsdigest"></a>
<pre><code class="language-json">&quot;sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3&quot;

</code></pre>
<p>Digest</p>
<h3><a class="header" href="#properties-18" id="properties-18">Properties</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>Digest</td><td>string</td><td>false</td><td>none</td><td>A digest string with prefixed algorithm. The format is described here:<br>https://github.com/opencontainers/image-spec/blob/master/descriptor.md#digests<br><br>Digests are used throughout the API to identify Layers and Manifests.</td></tr>
</tbody></table>
<h1><a class="header" href="#clairctl" id="clairctl">Clairctl</a></h1>
<p><code>clairctl</code> is a command line tool for working with Clair.
This CLI is capable of generating manifests from most public registries (dockerhub, quay.io, Red Hat Container Catalog) and submitting them for analysis to a running Clair.</p>
<pre><code>NAME:
   clairctl - A new cli application

USAGE:
   clairctl [global options] command [command options] [arguments...]

VERSION:
   0.1.0

DESCRIPTION:
   A command-line tool for clair v4.

COMMANDS:
   manifest  
   report    request vulnerability reports for the named containers
   help, h   Shows a list of commands or help for one command

GLOBAL OPTIONS:
   -D             print debugging logs (default: false)
   --help, -h     show help (default: false)
   --version, -v  print the version (default: false)
</code></pre>
<pre><code>NAME:
   clairctl manifest - 

USAGE:
   clairctl manifest [command options] [arguments...]

DESCRIPTION:
   print a clair manifest for the provided container

OPTIONS:
   --help, -h  show help (default: false)
</code></pre>
<pre><code>NAME:
   clairctl report - request vulnerability reports for the named containers

USAGE:
   clairctl report [command options] container...

DESCRIPTION:
   Request and print a Clair vulnerability report for the provided container(s).

OPTIONS:
   --host value           URL for the clairv4 v1 API. (default: &quot;http://localhost:6060/&quot;)
   --out value, -o value  output format: text, json, xml (default: text)
   --help, -h             show help (default: false)
</code></pre>
<h1><a class="header" href="#config" id="config">Config</a></h1>
<h2><a class="header" href="#cli-flags-and-env-vars" id="cli-flags-and-env-vars">CLI Flags And ENV Vars</a></h2>
<p>ClairV4 is provided a structured yaml configuration. 
Each ClairV4 node will specify what mode it will run in and config path via cli flag or environment variable.</p>
<p>For example:</p>
<pre><code class="language-shell">$ clair -conf ./path/to/config.yaml -mode indexer
$ clair -conf ./path/to/config.yaml -mode matcher
</code></pre>
<pre><code>-mode 
    (also specified by CLAIR_MODE env variable)
    One of the following strings
    Sets which mode the clair instances will run in
    
    &quot;indexer&quot;: runs just the indexer node
    &quot;matcher&quot;: runs just the matcher node
    &quot;notifier&quot;: runs just the notifier node
    &quot;combo&quot;:	will run both indexer and matcher on the same node.
-conf
    (also specified by CLAIR_CONF env variable)
    A file system path to Clair's config file
</code></pre>
<p>The above example starts two Clair nodes using the same configuration. One will only run the indexing facilities while the other will only run the matching facilities.</p>
<h2><a class="header" href="#config-reference" id="config-reference">Config Reference</a></h2>
<pre><code>http_listen_addr: &quot;&quot;
introspection_addr: &quot;&quot;
log_level: &quot;&quot;
indexer:
    connstring: &quot;&quot;
    scanlock_retry: 0
    layer_scan_concurrency: 0
    migrations: false
    scanner: {}
matcher:
    connstring: &quot;&quot;
    max_conn_pool: 0
    indexer_addr: &quot;&quot;
    migrations: false
    updater_sets: []
notifier:
    connstring: &quot;&quot;
    migrations: false
    indexer_addr: &quot;&quot;
    matcher_addr: &quot;&quot;
    poll_interval: &quot;&quot;
    delivery_interval: &quot;&quot;
    webhook: null
    amqp: null
    stomp: null
auth: {}
trace:
    name: &quot;&quot;
    probability: null
    jaeger:
        agent:
            endpoint: &quot;&quot;
        collector:
            endpoint: &quot;&quot;
            username: null
            password: null
        service_name: &quot;&quot;
        tags: {}
        buffer_max: 0
metrics:
    name: &quot;&quot;
    prometheus:
        endpoint: null
    dogstatsd:
        url: &quot;&quot;
</code></pre>
<h3><a class="header" href="#http_listen_addr" id="http_listen_addr">http_listen_addr: &quot;&quot;</a></h3>
<pre><code>A string in &lt;host&gt;:&lt;port&gt; format where &lt;host&gt; can be an empty string.

exposes Clair node's functionality to the network.
see /openapi/v1 for api spec.
</code></pre>
<h3><a class="header" href="#introspection_addr" id="introspection_addr">introspection_addr: &quot;&quot;</a></h3>
<pre><code>A string in &lt;host&gt;:&lt;port&gt; format where &lt;host&gt; can be an empty string.

exposes Clair's metrics and health endpoints.
</code></pre>
<h3><a class="header" href="#log_level" id="log_level">log_level: &quot;&quot;</a></h3>
<pre><code>Set the logging level.

One of the following strings:
&quot;debug-color&quot;
&quot;debug&quot;
&quot;info&quot;
&quot;warn&quot;
&quot;error&quot;
&quot;fatal&quot;
&quot;panic&quot;
</code></pre>
<h3><a class="header" href="#indexer-object" id="indexer-object">indexer: &lt;object&gt;</a></h3>
<pre><code>Indexer provides Clair Indexer node configuration
</code></pre>
<h4><a class="header" href="#connstring" id="connstring"> connstring: &quot;&quot;</a></h4>
<pre><code>A Postgres connection string.

formats:
url: &quot;postgres://pqgotest:password@localhost/pqgotest?sslmode=verify-full&quot;
or
string: &quot;user=pqgotest dbname=pqgotest sslmode=verify-full&quot;
</code></pre>
<h4><a class="header" href="#scanlock_retry-0" id="scanlock_retry-0"> scanlock_retry: 0</a></h4>
<pre><code>A positive value representing seconds.

Concurrent Indexers lock on manifest scans to avoid clobbering.
This value tunes how often a waiting Indexer will poll for the lock.
TODO: Move to async operating mode
</code></pre>
<h4><a class="header" href="#layer_scan_concurrency-0" id="layer_scan_concurrency-0"> layer_scan_concurrency: 0</a></h4>
<pre><code>A positive values represeting quantity.

Indexers will index a Manifest's layers concurrently.
This value tunes the number of layers an Indexer will scan in parallel.
</code></pre>
<h4><a class="header" href="#migrations-false" id="migrations-false"> migrations: false</a></h4>
<pre><code>A &quot;true&quot; or &quot;false&quot; value

Whether Indexer nodes handle migrations to their database.
</code></pre>
<h4><a class="header" href="#scanner-" id="scanner-"> scanner: {}</a></h4>
<pre><code>A map with the name of a particular scanner and arbitrary yaml as a value

Scanner allows for passing configuration options to layer scanners.
The scanner will have this configuration passed to it on construction if designed to do so.
</code></pre>
<h3><a class="header" href="#matcher-object" id="matcher-object">matcher: &lt;object&gt;</a></h3>
<pre><code>Matcher provides Clair matcher node configuration
</code></pre>
<h4><a class="header" href="#connstring-1" id="connstring-1"> connstring: &quot;&quot;</a></h4>
<pre><code>A Postgres connection string.

Formats:
url: &quot;postgres://pqgotest:password@localhost/pqgotest?sslmode=verify-full&quot;
or
string: &quot;user=pqgotest dbname=pqgotest sslmode=verify-full&quot;
</code></pre>
<h4><a class="header" href="#max_conn_pool-0" id="max_conn_pool-0"> max_conn_pool: 0</a></h4>
<pre><code>A positive integer

Clair allows for a custom connection pool size.
This number will directly set how many active sql
connections are allowed concurrently.
</code></pre>
<h4><a class="header" href="#indexer_addr" id="indexer_addr"> indexer_addr: &quot;&quot;</a></h4>
<pre><code>A string in &lt;host&gt;:&lt;port&gt; format where &lt;host&gt; can be an empty string.

A Matcher contacts an Indexer to create a VulnerabilityReport.
The location of this Indexer is required.
</code></pre>
<h4><a class="header" href="#migrations-false-1" id="migrations-false-1"> migrations: false</a></h4>
<pre><code>A &quot;true&quot; or &quot;false&quot; value

Whether Matcher nodes handle migrations to their databases.
</code></pre>
<h4><a class="header" href="#updater_sets-" id="updater_sets-"> updater_sets: []</a></h4>
<pre><code>A slice of strings representing which
updaters matcher will create.

If nil all default UpdaterSets will be used

The following sets are supported:
&quot;alpine&quot;
&quot;aws&quot;
&quot;debian&quot;
&quot;oracle&quot;
&quot;photon&quot;
&quot;pyupio&quot;
&quot;rhel&quot;
&quot;suse&quot;
&quot;ubuntu&quot;
</code></pre>
<h3><a class="header" href="#notifier-object" id="notifier-object">notifier: &lt;object&gt;</a></h3>
<pre><code>Notifier provides Clair Notifier node configuration
</code></pre>
<h4><a class="header" href="#connstring-2" id="connstring-2"> connstring: &quot;&quot;</a></h4>
<pre><code>
A Postgres connection string.

Formats:
url: &quot;postgres://pqgotest:password@localhost/pqgotest?sslmode=verify-full&quot;
or
string: &quot;user=pqgotest dbname=pqgotest sslmode=verify-full&quot;
</code></pre>
<h4><a class="header" href="#migrations-false-2" id="migrations-false-2"> migrations: false</a></h4>
<pre><code>A &quot;true&quot; or &quot;false&quot; value

Whether Notifier nodes handle migrations to their database.
</code></pre>
<h4><a class="header" href="#indexer_addr-1" id="indexer_addr-1"> indexer_addr: &quot;&quot;</a></h4>
<pre><code>A string in &lt;host&gt;:&lt;port&gt; format where &lt;host&gt; can be an empty string.

A Notifier contacts an Indexer to create obtain manifests affected by vulnerabilities.
The location of this Indexer is required.
</code></pre>
<h4><a class="header" href="#matcher_addr" id="matcher_addr"> matcher_addr: &quot;&quot;</a></h4>
<pre><code>A string in &lt;host&gt;:&lt;port&gt; format where &lt;host&gt; can be an empty string.

A Notifier contacts a Matcher to list update operations and acquire diffs.
The location of this Indexer is required.
</code></pre>
<h4><a class="header" href="#poll_interval" id="poll_interval"> poll_interval: &quot;&quot;</a></h4>
<pre><code>A time.ParseDuration parsable string

The frequency at which the notifier will query at Matcher for Update Operations.
</code></pre>
<h4><a class="header" href="#delivery_interval" id="delivery_interval"> delivery_interval: &quot;&quot;</a></h4>
<pre><code>A time.ParseDuration parsable string

The frequency at which the notifier attempt delivery of created or previously failed
notifications
</code></pre>
<h4><a class="header" href="#webhook-object" id="webhook-object"> webhook: &lt;object&gt;</a></h4>
<pre><code>Configures the notifier for webhook delivery
</code></pre>
<h4><a class="header" href="#target" id="target">  target: &quot;&quot;</a></h4>
<pre><code>URL where our webhook will be delivered

</code></pre>
<h4><a class="header" href="#callback" id="callback">  callback: &quot;&quot;</a></h4>
<pre><code>The callback url where notifications can be received
The notification will be appended to this url
This will typically be where the clair notifier is hosted
</code></pre>
<h4><a class="header" href="#headers" id="headers">  headers: &quot;&quot;</a></h4>
<pre><code>{ &quot;header&quot;: [ &quot;value&quot; ] }

A map associating header names to a list of header values
</code></pre>
<h4><a class="header" href="#signed" id="signed">  signed: &quot;&quot;</a></h4>
<pre><code>A &quot;true&quot; or &quot;false&quot; value

If true the Notifier will use its internal key server to sign out going webhooks.
</code></pre>
<h4><a class="header" href="#amqp-object" id="amqp-object"> amqp: &lt;object&gt;</a></h4>
<pre><code>Configures the notifier for AMQP delivery.
Note: Clair does not declare any AMQP components on its own.
All attempts to use an exchange or queue are passive only and will fail
The broker administrators should setup exchanges and queues ahead of time.
</code></pre>
<h4><a class="header" href="#direct" id="direct">  direct: &quot;&quot;</a></h4>
<pre><code>A &quot;true&quot; or &quot;false&quot; value

If true the Notifier will deliver individual notifications (not a callback) to the configured AMQP broker.
</code></pre>
<h4><a class="header" href="#rollup" id="rollup">  rollup: &quot;&quot;</a></h4>
<pre><code>Integer 0 or greater.

If direct is true this value will inform notifier how many notifications to send in a single direct delivery. 
For example if direct is set to true and rollup is set to 5 the notifier will deliver no more then 5 notifications in a single json payload to the broker.
</code></pre>
<h4><a class="header" href="#exchange-object" id="exchange-object">  exchange: &lt;object&gt;</a></h4>
<pre><code>The AMQP Exchange to connect to.
</code></pre>
<h4><a class="header" href="#name" id="name">   name: &quot;&quot;</a></h4>
<pre><code>string value

The name of the exchange to connect to.
</code></pre>
<h4><a class="header" href="#type" id="type">   type: &quot;&quot;</a></h4>
<pre><code>string value

The type of the exchange. Typically:
&quot;direct&quot;
&quot;fanout&quot;
&quot;topic&quot;
&quot;headers&quot;
</code></pre>
<h4><a class="header" href="#durability-false" id="durability-false">   durability: false</a></h4>
<pre><code>bool value

Whether the configured queue is durable or not.
</code></pre>
<h4><a class="header" href="#auto_delete-false" id="auto_delete-false">   auto_delete: false</a></h4>
<pre><code>bool value

Whether the configured queue uses an auto_delete policy.
</code></pre>
<h4><a class="header" href="#routing_key" id="routing_key">   routing_key: &quot;&quot;</a></h4>
<pre><code>string value

The name of the routing key each notification will be sent with.
</code></pre>
<h4><a class="header" href="#callback-1" id="callback-1">  callback: &quot;&quot;</a></h4>
<pre><code>a URL string 

If direct is false this URL is provided in the notificaition callback sent to the broker.
This URL should point to Clair's notification API endpoint.
</code></pre>
<h4><a class="header" href="#uris-" id="uris-">  uris: []</a></h4>
<pre><code>list of URL string

A list of one or more AMQP brokers to connect to in priority order.
Clair will attempt to connect to the first one in the list and if this
fails will try any subsuquent in specified order.
</code></pre>
<h4><a class="header" href="#tls-object" id="tls-object">  tls: &lt;object&gt;</a></h4>
<pre><code>Configures TLS connection to AMQP broker
</code></pre>
<h4><a class="header" href="#root_ca" id="root_ca">   root_ca: &quot;&quot;</a></h4>
<pre><code>string value

The filesystem path where a root CA can be read.
</code></pre>
<h4><a class="header" href="#cert" id="cert">   cert: &quot;&quot;</a></h4>
<pre><code>string value

The filesystem path where a tls certificate can be read.
</code></pre>
<h4><a class="header" href="#key" id="key">   key: &quot;&quot;</a></h4>
<pre><code>string value

The filesystem path where a tls private key can be read.
</code></pre>
<h4><a class="header" href="#stomp-object" id="stomp-object"> stomp: &lt;object&gt;</a></h4>
<pre><code>Configures the notifier for STOMP delivery.
</code></pre>
<h4><a class="header" href="#direct-1" id="direct-1">  direct: &quot;&quot;</a></h4>
<pre><code>A &quot;true&quot; or &quot;false&quot; value

If true the Notifier will deliver individual notifications (not a callback) to the configured STOMP broker.
</code></pre>
<h4><a class="header" href="#rollup-1" id="rollup-1">  rollup: &quot;&quot;</a></h4>
<pre><code>Integer 0 or greater.

If direct is true this value will inform notifier how many notifications to send in a single direct delivery. 
For example if direct is set to true and rollup is set to 5 the notifier will deliver no more then 5 notifications in a single json payload to the broker.
</code></pre>
<h4><a class="header" href="#callback-2" id="callback-2">  callback: &quot;&quot;</a></h4>
<pre><code>a URL string 

If direct is false this URL is provided in the notificaition callback sent to the broker.
This URL should point to Clair's notification API endpoint.
</code></pre>
<h4><a class="header" href="#destination" id="destination">  destination: &quot;&quot;</a></h4>
<pre><code>a string value

The STOMP destination to deliver notifications to. 
</code></pre>
<h4><a class="header" href="#uris--1" id="uris--1">  uris: []</a></h4>
<pre><code>list of URL string

A list of one or more STOMP brokers to connect to in priority order.
Clair will attempt to connect to the first one in the list and if this
fails will try any subsuquent in specified order.
</code></pre>
<h4><a class="header" href="#tls-object-1" id="tls-object-1">  tls: &lt;object&gt;</a></h4>
<pre><code>Configures TLS connection to STOMP broker
</code></pre>
<h4><a class="header" href="#root_ca-1" id="root_ca-1">   root_ca: &quot;&quot;</a></h4>
<pre><code>string value

The filesystem path where a root CA can be read.
</code></pre>
<h4><a class="header" href="#cert-1" id="cert-1">   cert: &quot;&quot;</a></h4>
<pre><code>string value

The filesystem path where a tls certificate can be read.
</code></pre>
<h4><a class="header" href="#key-1" id="key-1">   key: &quot;&quot;</a></h4>
<pre><code>string value

The filesystem path where a tls private key can be read.
</code></pre>
<h4><a class="header" href="#user-object" id="user-object">   user: &lt;object&gt;</a></h4>
<pre><code>Configures login information for conneting to a STOMP broker
</code></pre>
<h4><a class="header" href="#login" id="login">   login: &quot;&quot;</a></h4>
<pre><code>string value

The STOMP login to connect with.
</code></pre>
<h4><a class="header" href="#passcode" id="passcode">   passcode: &quot;&quot;</a></h4>
<pre><code>string value

The STOMP passcode to connect with.
</code></pre>
<h3><a class="header" href="#auth-object" id="auth-object">auth: &lt;object&gt;</a></h3>
<pre><code>Defines ClairV4's external and intra-service JWT based authentication.

If multiple auth mechanisms are defined the Keyserver is preferred.
</code></pre>
<h3><a class="header" href="#psk-object" id="psk-object"> psk: &lt;object&gt;</a></h3>
<pre><code>Defines pre-shard-key authentication
</code></pre>
<h4><a class="header" href="#key-2" id="key-2">  key: &quot;&quot;</a></h4>
<pre><code>a string value

A shared key distributed between all parties signing and verifying JWTs.
</code></pre>
<h4><a class="header" href="#issuer" id="issuer">  issuer: &quot;&quot;</a></h4>
<pre><code>a string value

The &quot;Issuer&quot; key is what the service expects to verify as the &quot;issuer&quot; claim.
</code></pre>
<h3><a class="header" href="#keyserver-object" id="keyserver-object"> keyserver: &lt;object&gt;</a></h3>
<pre><code>Defines Quay keyserver authentication
</code></pre>
<h4><a class="header" href="#api" id="api">  api: &quot;&quot;</a></h4>
<pre><code>a string value

The API where Quay Keyserver can be reached.
</code></pre>
<h4><a class="header" href="#intraservice-1" id="intraservice-1">  intraservice: &quot;&quot;</a></h4>
<pre><code>a string value

A key shared between all Clair nodes for intra-service JWT authentication.
</code></pre>
<h3><a class="header" href="#trace-object" id="trace-object">trace: &lt;object&gt;</a></h3>
<pre><code>Defines distributed tracing configuration based on OpenTelemtry
</code></pre>
<h4><a class="header" href="#name-1" id="name-1"> name: &quot;&quot;</a></h4>
<pre><code>a string value

The name of the application traces will belong to.
</code></pre>
<h4><a class="header" href="#probability-00" id="probability-00"> probability: 0.0</a></h4>
<pre><code>a float value

The probabality a trace will occur
</code></pre>
<h4><a class="header" href="#jaeger-object" id="jaeger-object"> Jaeger: &lt;object&gt;</a></h4>
<pre><code>Defines values for Jaeger tracing
</code></pre>
<h4><a class="header" href="#agent-object" id="agent-object">  agent: &lt;object&gt;</a></h4>
<pre><code>Defines values for a Jaeger agent
</code></pre>
<h4><a class="header" href="#endpoint" id="endpoint">   endpoint: &quot;&quot;</a></h4>
<pre><code>a string value

An address in &lt;host&gt;:&lt;post&gt; syntax where the agent will deliver traces.
</code></pre>
<h4><a class="header" href="#collector-object" id="collector-object">   collector: &lt;object&gt;</a></h4>
<pre><code>Defines values for a Jaeger collector
</code></pre>
<h4><a class="header" href="#endpoint-1" id="endpoint-1">   endpoint: &quot;&quot;</a></h4>
<pre><code>a string value

An address in &lt;host&gt;:&lt;post&gt; syntax where the agent will deliver traces.
</code></pre>
<h4><a class="header" href="#username" id="username">   username: &quot;&quot;</a></h4>
<pre><code>a string value
</code></pre>
<h4><a class="header" href="#passwordd" id="passwordd">   passwordd: &quot;&quot;</a></h4>
<pre><code>a string value
</code></pre>
<h4><a class="header" href="#service_name" id="service_name">  service_name: &quot;&quot;</a></h4>
<pre><code>a string value
</code></pre>
<h4><a class="header" href="#tags-" id="tags-">  tags: {}</a></h4>
<pre><code>a mapping of a string to a string
</code></pre>
<h4><a class="header" href="#buffer_max-0" id="buffer_max-0">  buffer_max: 0</a></h4>
<pre><code>a integer value
</code></pre>
<h3><a class="header" href="#metrics-object" id="metrics-object">metrics: &lt;object&gt;</a></h3>
<pre><code>Defines distributed tracing configuration based on OpenTelemtry
</code></pre>
<h4><a class="header" href="#name-2" id="name-2"> name: &quot;&quot;</a></h4>
<pre><code>a string value
</code></pre>
<h3><a class="header" href="#prometheus-object" id="prometheus-object"> prometheus: &lt;object&gt;</a></h3>
<pre><code>Defines distributed tracing configuration based on OpenTelemtry
</code></pre>
<h4><a class="header" href="#endpoint-2" id="endpoint-2">  endpoint: &quot;&quot;</a></h4>
<pre><code>a string value
</code></pre>
<h3><a class="header" href="#dogstatsd-object" id="dogstatsd-object"> dogstatsd: &lt;object&gt;</a></h3>
<pre><code>Defines distributed tracing configuration based on OpenTelemtry
</code></pre>
<h4><a class="header" href="#url" id="url">  url: &quot;&quot;</a></h4>
<pre><code>a string value
</code></pre>
<h1><a class="header" href="#indexer" id="indexer">Indexer</a></h1>
<p>When Clair is running in Indexer mode, it is responsible for receiving Manifests and generating IndexReports. An IndexReport is an intermediate representation of a manifest's content and is used to discover vulnerabilities.</p>
<h1><a class="header" href="#matcher" id="matcher">Matcher</a></h1>
<p>When Clair is running in Matcher mode it is responsible for receiving IndexReports and generating VulnerabilityReports. A VulnerabilityReport describes the contents of a manifest and any vulnerabilities affecting it.</p>
<h1><a class="header" href="#notifier" id="notifier">Notifier</a></h1>
<p>When Clair is running in Notifier mode, it is responsible for generating notifications when new vulnerabilities affecting a previously indexed manifest enters the system. The notifier will send notifications via the configured mechanisms.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
